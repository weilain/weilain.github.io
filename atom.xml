<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hermoso</title>
  
  
  <link href="https://imszz.com/atom.xml" rel="self"/>
  
  <link href="https://imszz.com/"/>
  <updated>2021-01-26T12:46:25.000Z</updated>
  <id>https://imszz.com/</id>
  
  <author>
    <name>Hermoso</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MySQL5.7 é«˜å¯ç”¨é«˜æ€§èƒ½é…ç½®è°ƒä¼˜ æ€§èƒ½å‚æ•°å‚è€ƒ</title>
    <link href="https://imszz.com/p/2d27b747/"/>
    <id>https://imszz.com/p/2d27b747/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2021-01-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>MySQL5.7 åœ¨ 5.6 ç‰ˆæœ¬çš„åŸºç¡€ä¹‹ä¸Šåšäº†å¤§é‡çš„ä¼˜åŒ–, æœ¬ç¯‡æ–‡ç« å¼€ç¯‡å°†é‡ç‚¹å›´ç»•ç»è¿‡ä¼˜åŒ–çš„åŸºäº GTID çš„å¤šçº¿ç¨‹å¤åˆ¶å’ŒåŠåŒæ­¥å¤åˆ¶çš„ç‰¹æ€§ä»‹ç», åç»­ä¼šæŒç»­å¢åŠ  MySQL5.7 çš„è°ƒä¼˜å‚æ•°</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set &#x3D; utf8mb4</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line"></span><br><span class="line">### åŸºæœ¬å±æ€§é…ç½®</span><br><span class="line">port &#x3D; 3306</span><br><span class="line">datadir&#x3D;&#x2F;data&#x2F;mysql</span><br><span class="line"># ç¦ç”¨ä¸»æœºåè§£æ</span><br><span class="line">skip-name-resolve</span><br><span class="line"># é»˜è®¤çš„æ•°æ®åº“å¼•æ“</span><br><span class="line">default-storage-engine &#x3D; InnoDB</span><br><span class="line"></span><br><span class="line">### å­—ç¬¦é›†é…ç½®</span><br><span class="line">character-set-client-handshake &#x3D; FALSE</span><br><span class="line">character-set-server &#x3D; utf8mb4</span><br><span class="line">collation-server &#x3D; utf8mb4_unicode_ci</span><br><span class="line">init_connect&#x3D;&#39;SET NAMES utf8mb4&#39;</span><br><span class="line"></span><br><span class="line">### GTID</span><br><span class="line">server_id &#x3D; 59</span><br><span class="line"># ä¸ºä¿è¯ GTID å¤åˆ¶çš„ç¨³å®š, è¡Œçº§æ—¥å¿—</span><br><span class="line">binlog_format &#x3D; row</span><br><span class="line"># å¼€å¯ gtid åŠŸèƒ½</span><br><span class="line">gtid_mode &#x3D; on</span><br><span class="line"># ä¿éšœ GTID äº‹åŠ¡å®‰å…¨</span><br><span class="line"># å½“å¯ç”¨enforce_gtid_consistencyåŠŸèƒ½çš„æ—¶å€™,</span><br><span class="line"># MySQLåªå…è®¸èƒ½å¤Ÿä¿éšœäº‹åŠ¡å®‰å…¨, å¹¶ä¸”èƒ½å¤Ÿè¢«æ—¥å¿—è®°å½•çš„SQLè¯­å¥è¢«æ‰§è¡Œ,</span><br><span class="line"># åƒcreate table ... select å’Œ create temporarytableè¯­å¥, </span><br><span class="line"># ä»¥åŠåŒæ—¶æ›´æ–°äº‹åŠ¡è¡¨å’Œéäº‹åŠ¡è¡¨çš„SQLè¯­å¥æˆ–äº‹åŠ¡éƒ½ä¸å…è®¸æ‰§è¡Œ</span><br><span class="line">enforce-gtid-consistency &#x3D; true</span><br><span class="line"># ä»¥ä¸‹ä¸¤æ¡é…ç½®ä¸ºä¸»ä»åˆ‡æ¢, æ•°æ®åº“é«˜å¯ç”¨çš„å¿…é¡»é…ç½®</span><br><span class="line"># å¼€å¯ binlog æ—¥å¿—åŠŸèƒ½</span><br><span class="line">log_bin &#x3D; on</span><br><span class="line"># å¼€å¯ä»åº“æ›´æ–° binlog æ—¥å¿—</span><br><span class="line">log-slave-updates &#x3D; on</span><br><span class="line"></span><br><span class="line">### æ…¢æŸ¥è¯¢æ—¥å¿—</span><br><span class="line"># æ‰“å¼€æ…¢æŸ¥è¯¢æ—¥å¿—åŠŸèƒ½</span><br><span class="line">slow_query_log &#x3D; 1</span><br><span class="line"># è¶…è¿‡2ç§’çš„æŸ¥è¯¢è®°å½•ä¸‹æ¥</span><br><span class="line">long_query_time &#x3D; 2</span><br><span class="line"># è®°å½•ä¸‹æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢</span><br><span class="line">log_queries_not_using_indexes &#x3D; 1</span><br><span class="line"></span><br><span class="line">### è‡ªåŠ¨ä¿®å¤</span><br><span class="line"># è®°å½• relay.info åˆ°æ•°æ®è¡¨ä¸­</span><br><span class="line">relay_log_info_repository &#x3D; TABLE</span><br><span class="line"># è®°å½• master.info åˆ°æ•°æ®è¡¨ä¸­ </span><br><span class="line">master_info_repository &#x3D; TABLE</span><br><span class="line"># å¯ç”¨ relaylog çš„è‡ªåŠ¨ä¿®å¤åŠŸèƒ½</span><br><span class="line">relay_log_recovery &#x3D; on</span><br><span class="line"># åœ¨ SQL çº¿ç¨‹æ‰§è¡Œå®Œä¸€ä¸ª relaylog åè‡ªåŠ¨åˆ é™¤</span><br><span class="line">relay_log_purge &#x3D; 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### æ•°æ®å®‰å…¨æ€§é…ç½®</span><br><span class="line"># å…³é—­ master åˆ›å»º function çš„åŠŸèƒ½</span><br><span class="line">log_bin_trust_function_creators &#x3D; off</span><br><span class="line"># æ¯æ‰§è¡Œä¸€ä¸ªäº‹åŠ¡éƒ½å¼ºåˆ¶å†™å…¥ç£ç›˜</span><br><span class="line">sync_binlog &#x3D; 1</span><br><span class="line"># timestamp åˆ—å¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ä¸º not null, åˆ™æ”¯æŒnullå±æ€§</span><br><span class="line"># è®¾ç½® timestamp çš„åˆ—å€¼ä¸º null, ä¸ä¼šè¢«è®¾ç½®ä¸º current timestamp</span><br><span class="line">explicit_defaults_for_timestamp&#x3D;true</span><br><span class="line"></span><br><span class="line">### ä¼˜åŒ–é…ç½®</span><br><span class="line"># ä¼˜åŒ–ä¸­æ–‡å…¨æ–‡æ¨¡ç³Šç´¢å¼•</span><br><span class="line">ft_min_word_len &#x3D; 1</span><br><span class="line"># é»˜è®¤åº“åè¡¨åä¿å­˜ä¸ºå°å†™, ä¸åŒºåˆ†å¤§å°å†™</span><br><span class="line">lower_case_table_names &#x3D; 1</span><br><span class="line"># å•æ¡è®°å½•å†™å…¥æœ€å¤§çš„å¤§å°é™åˆ¶</span><br><span class="line"># è¿‡å°å¯èƒ½ä¼šå¯¼è‡´å†™å…¥(å¯¼å…¥)æ•°æ®å¤±è´¥</span><br><span class="line">max_allowed_packet &#x3D; 256M</span><br><span class="line"># åŠåŒæ­¥å¤åˆ¶å¼€å¯</span><br><span class="line">rpl_semi_sync_master_enabled &#x3D; 1</span><br><span class="line">rpl_semi_sync_slave_enabled &#x3D; 1</span><br><span class="line"># åŠåŒæ­¥å¤åˆ¶è¶…æ—¶æ—¶é—´è®¾ç½®</span><br><span class="line">rpl_semi_sync_master_timeout &#x3D; 1000</span><br><span class="line"># å¤åˆ¶æ¨¡å¼(ä¿æŒç³»ç»Ÿé»˜è®¤)</span><br><span class="line">rpl_semi_sync_master_wait_point &#x3D; AFTER_SYNC</span><br><span class="line"># åç«¯åªè¦æœ‰ä¸€å°æ”¶åˆ°æ—¥å¿—å¹¶å†™å…¥ relaylog å°±ç®—æˆåŠŸ</span><br><span class="line">rpl_semi_sync_master_wait_slave_count &#x3D; 1</span><br><span class="line"># å¤šçº¿ç¨‹å¤åˆ¶</span><br><span class="line">slave_parallel_type &#x3D; logical_clock</span><br><span class="line">slave_parallel_workers &#x3D; 4</span><br><span class="line"></span><br><span class="line">### è¿æ¥æ•°é™åˆ¶</span><br><span class="line">max_connections &#x3D; 1500</span><br><span class="line"># éªŒè¯å¯†ç è¶…è¿‡20æ¬¡æ‹’ç»è¿æ¥</span><br><span class="line">max_connect_errors &#x3D; 20</span><br><span class="line"># back_logå€¼æŒ‡å‡ºåœ¨mysqlæš‚æ—¶åœæ­¢å›ç­”æ–°è¯·æ±‚ä¹‹å‰çš„çŸ­æ—¶é—´å†…å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥è¢«å­˜åœ¨å †æ ˆä¸­</span><br><span class="line"># ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœMySqlçš„è¿æ¥æ•°è¾¾åˆ°max_connectionsæ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­</span><br><span class="line"># ä»¥ç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥å †æ ˆçš„æ•°é‡å³back_logï¼Œå¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_log</span><br><span class="line"># å°†ä¸è¢«æˆäºˆè¿æ¥èµ„æº</span><br><span class="line">back_log &#x3D; 500</span><br><span class="line">open_files_limit &#x3D; 65535</span><br><span class="line"># æœåŠ¡å™¨å…³é—­äº¤äº’å¼è¿æ¥å‰ç­‰å¾…æ´»åŠ¨çš„ç§’æ•°</span><br><span class="line">interactive_timeout &#x3D; 3600</span><br><span class="line"># æœåŠ¡å™¨å…³é—­éäº¤äº’è¿æ¥ä¹‹å‰ç­‰å¾…æ´»åŠ¨çš„ç§’æ•°</span><br><span class="line">wait_timeout &#x3D; 3600</span><br><span class="line"></span><br><span class="line">### å†…å­˜åˆ†é…</span><br><span class="line"># æŒ‡å®šè¡¨é«˜é€Ÿç¼“å­˜çš„å¤§å°ã€‚æ¯å½“MySQLè®¿é—®ä¸€ä¸ªè¡¨æ—¶ï¼Œå¦‚æœåœ¨è¡¨ç¼“å†²åŒºä¸­è¿˜æœ‰ç©ºé—´</span><br><span class="line"># è¯¥è¡¨å°±è¢«æ‰“å¼€å¹¶æ”¾å…¥å…¶ä¸­ï¼Œè¿™æ ·å¯ä»¥æ›´å¿«åœ°è®¿é—®è¡¨å†…å®¹</span><br><span class="line">table_open_cache &#x3D; 1024</span><br><span class="line"># ä¸ºæ¯ä¸ªsession åˆ†é…çš„å†…å­˜, åœ¨äº‹åŠ¡è¿‡ç¨‹ä¸­ç”¨æ¥å­˜å‚¨äºŒè¿›åˆ¶æ—¥å¿—çš„ç¼“å­˜</span><br><span class="line">binlog_cache_size &#x3D; 2M</span><br><span class="line"># åœ¨å†…å­˜çš„ä¸´æ—¶è¡¨æœ€å¤§å¤§å°</span><br><span class="line">tmp_table_size &#x3D; 128M</span><br><span class="line"># åˆ›å»ºå†…å­˜è¡¨çš„æœ€å¤§å¤§å°(ä¿æŒç³»ç»Ÿé»˜è®¤, ä¸å…è®¸åˆ›å»ºè¿‡å¤§çš„å†…å­˜è¡¨)</span><br><span class="line"># å¦‚æœæœ‰éœ€æ±‚å½“åšç¼“å­˜æ¥ç”¨, å¯ä»¥é€‚å½“è°ƒå¤§æ­¤å€¼</span><br><span class="line">max_heap_table_size &#x3D; 16M</span><br><span class="line"># é¡ºåºè¯», è¯»å…¥ç¼“å†²åŒºå¤§å°è®¾ç½®</span><br><span class="line"># å…¨è¡¨æ‰«ææ¬¡æ•°å¤šçš„è¯, å¯ä»¥è°ƒå¤§æ­¤å€¼</span><br><span class="line">read_buffer_size &#x3D; 1M</span><br><span class="line"># éšæœºè¯», è¯»å…¥ç¼“å†²åŒºå¤§å°è®¾ç½®</span><br><span class="line">read_rnd_buffer_size &#x3D; 8M</span><br><span class="line"># é«˜å¹¶å‘çš„æƒ…å†µä¸‹, éœ€è¦å‡å°æ­¤å€¼åˆ°64K-128K</span><br><span class="line">sort_buffer_size &#x3D; 1M</span><br><span class="line"># æ¯ä¸ªæŸ¥è¯¢æœ€å¤§çš„ç¼“å­˜å¤§å°æ˜¯1M, æœ€å¤§ç¼“å­˜64M æ•°æ®</span><br><span class="line">query_cache_size &#x3D; 64M</span><br><span class="line">query_cache_limit &#x3D; 1M</span><br><span class="line"># æåˆ° join çš„æ•ˆç‡</span><br><span class="line">join_buffer_size &#x3D; 16M</span><br><span class="line"># çº¿ç¨‹è¿æ¥é‡å¤åˆ©ç”¨</span><br><span class="line">thread_cache_size &#x3D; 64</span><br><span class="line"></span><br><span class="line">### InnoDB ä¼˜åŒ–</span><br><span class="line">## å†…å­˜åˆ©ç”¨æ–¹é¢çš„è®¾ç½®</span><br><span class="line"># æ•°æ®ç¼“å†²åŒº</span><br><span class="line">innodb_buffer_pool_size&#x3D;2G</span><br><span class="line">## æ—¥å¿—æ–¹é¢è®¾ç½®</span><br><span class="line"># äº‹åŠ¡æ—¥å¿—å¤§å°</span><br><span class="line">innodb_log_file_size &#x3D; 256M</span><br><span class="line"># æ—¥å¿—ç¼“å†²åŒºå¤§å°</span><br><span class="line">innodb_log_buffer_size &#x3D; 4M</span><br><span class="line"># äº‹åŠ¡åœ¨å†…å­˜ä¸­çš„ç¼“å†²</span><br><span class="line">innodb_log_buffer_size &#x3D; 3M</span><br><span class="line"># ä¸»åº“ä¿æŒç³»ç»Ÿé»˜è®¤, äº‹åŠ¡ç«‹å³å†™å…¥ç£ç›˜, ä¸ä¼šä¸¢å¤±ä»»ä½•ä¸€ä¸ªäº‹åŠ¡</span><br><span class="line">innodb_flush_log_at_trx_commit &#x3D; 1</span><br><span class="line"># mysql çš„æ•°æ®æ–‡ä»¶è®¾ç½®, åˆå§‹100, ä»¥10M è‡ªåŠ¨æ‰©å±•</span><br><span class="line">innodb_data_file_path &#x3D; ibdata1:100M:autoextend</span><br><span class="line"># ä¸ºæé«˜æ€§èƒ½, MySQLå¯ä»¥ä»¥å¾ªç¯æ–¹å¼å°†æ—¥å¿—æ–‡ä»¶å†™åˆ°å¤šä¸ªæ–‡ä»¶</span><br><span class="line">innodb_log_files_in_group &#x3D; 3</span><br><span class="line">##å…¶ä»–è®¾ç½®</span><br><span class="line"># å¦‚æœåº“é‡Œçš„è¡¨ç‰¹åˆ«å¤šçš„æƒ…å†µï¼Œè¯·å¢åŠ æ­¤å€¼</span><br><span class="line">innodb_open_files &#x3D; 800</span><br><span class="line"># ä¸ºæ¯ä¸ª InnoDB è¡¨åˆ†é…å•ç‹¬çš„è¡¨ç©ºé—´</span><br><span class="line">innodb_file_per_table &#x3D; 1</span><br><span class="line"># InnoDB ä½¿ç”¨åå°çº¿ç¨‹å¤„ç†æ•°æ®é¡µä¸Šå†™ I&#x2F;Oï¼ˆè¾“å…¥ï¼‰è¯·æ±‚çš„æ•°é‡</span><br><span class="line">innodb_write_io_threads &#x3D; 8</span><br><span class="line"># InnoDB ä½¿ç”¨åå°çº¿ç¨‹å¤„ç†æ•°æ®é¡µä¸Šè¯» I&#x2F;Oï¼ˆè¾“å‡ºï¼‰è¯·æ±‚çš„æ•°é‡</span><br><span class="line">innodb_read_io_threads &#x3D; 8</span><br><span class="line"># å¯ç”¨å•ç‹¬çš„çº¿ç¨‹æ¥å›æ”¶æ— ç”¨çš„æ•°æ®</span><br><span class="line">innodb_purge_threads &#x3D; 1</span><br><span class="line"># è„æ•°æ®åˆ·å…¥ç£ç›˜(å…ˆä¿æŒç³»ç»Ÿé»˜è®¤, swap è¿‡å¤šä½¿ç”¨æ—¶, è°ƒå°æ­¤å€¼, è°ƒå°å, ä¸ç£ç›˜äº¤äº’å¢å¤š, æ€§èƒ½é™ä½)</span><br><span class="line"># innodb_max_dirty_pages_pct &#x3D; 90</span><br><span class="line"># äº‹åŠ¡ç­‰å¾…è·å–èµ„æºç­‰å¾…çš„æœ€é•¿æ—¶é—´</span><br><span class="line">innodb_lock_wait_timeout &#x3D; 120</span><br><span class="line"># å¼€å¯ InnoDB ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼, ä¸è­¦å‘Š, ç›´æ¥æŠ¥é”™</span><br><span class="line">innodb_strict_mode&#x3D;1</span><br><span class="line"># å…è®¸åˆ—ç´¢å¼•æœ€å¤§è¾¾åˆ°3072</span><br><span class="line"> innodb_large_prefix &#x3D; on</span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line"># å¼€å¯å¿«é€Ÿå¯¼å‡º</span><br><span class="line">quick</span><br><span class="line">default-character-set &#x3D; utf8mb4</span><br><span class="line">max_allowed_packet &#x3D; 256M</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line"># å¼€å¯ tab è¡¥å…¨</span><br><span class="line">auto-rehash</span><br><span class="line">default-character-set &#x3D; utf8mb4</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;MySQL5.7 åœ¨ 5.6 ç‰ˆæœ¬çš„åŸºç¡€ä¹‹ä¸Šåšäº†å¤§é‡çš„ä¼˜åŒ–, æœ¬ç¯‡æ–‡ç« å¼€ç¯‡å°†é‡ç‚¹å›´ç»•ç»è¿‡ä¼˜åŒ–çš„åŸºäº GTID çš„å¤šçº¿ç¨‹å¤åˆ¶å’ŒåŠåŒæ­¥å¤åˆ¶çš„ç‰¹æ€§ä»‹ç», åç»­ä¼šæŒç»­å¢åŠ  MySQL5.7 çš„è°ƒä¼˜å‚æ•°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure c</summary>
      
    
    
    
    <category term="Mysql" scheme="https://imszz.com/categories/Mysql/"/>
    
    
    <category term="mysql" scheme="https://imszz.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>MySQL5.7 å­—ç¬¦é›†è®¾ç½®</title>
    <link href="https://imszz.com/p/38510659/"/>
    <id>https://imszz.com/p/38510659/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2021-01-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="mysql57-å­—ç¬¦é›†è®¾ç½®">MySQL5.7 å­—ç¬¦é›†è®¾ç½®</span></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">character-set-client-handshake &#x3D; FALSE</span><br><span class="line">character-set-server &#x3D; utf8mb4</span><br><span class="line">collation-server &#x3D; utf8mb4_unicode_ci</span><br><span class="line">init_connect&#x3D;â€™SET NAMES utf8mb4â€™</span><br></pre></td></tr></table></figure><h1><span id="character-set-client-handshake">character-set-client-handshake</span></h1><p>ç”¨æ¥æ§åˆ¶å®¢æˆ·ç«¯å£°æ˜ä½¿ç”¨å­—ç¬¦é›†å’ŒæœåŠ¡ç«¯å£°æ˜ä½¿ç”¨çš„å­—ç¬¦é›†åœ¨ä¸ä¸€è‡´çš„æƒ…å†µä¸‹çš„å…¼å®¹æ€§.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">character-set-client-handshake &#x3D; false</span><br><span class="line"># è®¾ç½®ä¸º False, åœ¨å®¢æˆ·ç«¯å­—ç¬¦é›†å’ŒæœåŠ¡ç«¯å­—ç¬¦é›†ä¸åŒçš„æ—¶å€™å°†æ‹’ç»è¿æ¥åˆ°æœåŠ¡ç«¯æ‰§è¡Œä»»ä½•æ“ä½œ</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># é»˜è®¤ä¸º true</span><br><span class="line">character-set-client-handshake &#x3D; true</span><br><span class="line"># è®¾ç½®ä¸º True, å³ä½¿å®¢æˆ·ç«¯å­—ç¬¦é›†å’ŒæœåŠ¡ç«¯å­—ç¬¦é›†ä¸åŒ, ä¹Ÿå…è®¸å®¢æˆ·ç«¯è¿æ¥</span><br></pre></td></tr></table></figure><h1><span id="character-set-server">character-set-server</span></h1><p>å£°æ˜æœåŠ¡ç«¯çš„å­—ç¬¦ç¼–ç , æ¨èä½¿ç”¨utf8mb4 , è¯¥å­—ç¬¦è™½ç„¶å ç”¨ç©ºé—´ä¼šæ¯”è¾ƒå¤§, ä½†æ˜¯å¯ä»¥å…¼å®¹ emoji ğŸ˜ˆ è¡¨æƒ…çš„å­˜å‚¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">character-set-server &#x3D; utf8mb4</span><br></pre></td></tr></table></figure><h1><span id="collation-server">collation-server</span></h1><p>å£°æ˜æœåŠ¡ç«¯çš„å­—ç¬¦é›†, å­—ç¬¦ç¼–ç å’Œå­—ç¬¦é›†ä¸€ä¸€å¯¹åº”, æ—¢ç„¶ä½¿ç”¨äº†utf8mb4çš„å­—ç¬¦é›†, å°±è¦å£°æ˜ä½¿ç”¨å¯¹åº”çš„å­—ç¬¦ç¼–ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collation-server &#x3D; utf8mb4_unicode_ci</span><br></pre></td></tr></table></figure><h1><span id="init_connect">init_connect</span></h1><p><code>init_connect </code>æ˜¯ç”¨æˆ·ç™»å½•åˆ°æ•°æ®åº“ä¸Šä¹‹å, åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æŸ¥è¯¢ä¹‹å‰æ‰§è¡Œé‡Œé¢çš„å†…å®¹. å¦‚æœ <code>init_connect</code> çš„å†…å®¹æœ‰è¯­æ³•é”™è¯¯, å¯¼è‡´æ‰§è¡Œå¤±è´¥, ä¼šå¯¼è‡´ç”¨æˆ·æ— æ³•æ‰§è¡ŒæŸ¥è¯¢, ä»mysql é€€å‡º</p><p>ä½¿ç”¨ <code>init_connect</code> æ‰§è¡Œ <code>SET NAMES utf8mb4</code> æ„ä¸º:</p><p>å£°æ˜è‡ªå·±(å®¢æˆ·ç«¯)ä½¿ç”¨çš„æ˜¯ utf8mb4 çš„å­—ç¬¦ç¼–ç <br>å¸Œæœ›æœåŠ¡å™¨è¿”å›ç»™è‡ªå·± utf8mb4 çš„æŸ¥è¯¢ç»“æœ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">init_connect &#x3D; &#39;SET NAMES utf8mb4&#39;</span><br></pre></td></tr></table></figure><h1><span id="å®Œæ•´é…ç½®">å®Œæ•´é…ç½®</span></h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">character-set-client-handshake &#x3D; FALSE</span><br><span class="line">character-set-server &#x3D; utf8mb4</span><br><span class="line">collation-server &#x3D; utf8mb4_unicode_ci</span><br><span class="line">init_connect &#x3D; &#39;SET NAMES utf8mb4&#39;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;mysql57-å­—ç¬¦é›†è®¾ç½®&quot;&gt;MySQL5.7 å­—ç¬¦é›†è®¾ç½®&lt;/span&gt;&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;</summary>
      
    
    
    
    <category term="Mysql" scheme="https://imszz.com/categories/Mysql/"/>
    
    
    <category term="mysql" scheme="https://imszz.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>mysql å®‰è£…5.7</title>
    <link href="https://imszz.com/p/d47d8d30/"/>
    <id>https://imszz.com/p/d47d8d30/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2021-01-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="mysqlç¼–è¯‘å’Œå®‰è£…">MySQLç¼–è¯‘å’Œå®‰è£…</span></h1><p>##åœ¨<code>CentOS7</code>ä¸­ç¼–è¯‘å®‰è£…<code>MySQL 5.7.21</code>. ä¾èµ–å’Œæºç åŒ… å®‰è£…ç›¸å…³çš„ä¾èµ–: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc gcc-c++ ncurses ncurses-devel cmake bison openssl-devel -y </span><br><span class="line">yum install make cmake gcc gcc-c++ bison bison-devel ncurses ncurses-devel autoconf automake</span><br></pre></td></tr></table></figure><p>ä¸‹è½½<code>MySQL 5.7.32</code>æºç åŒ…å’Œä¾èµ–<code>boost</code>, <code>MySQL 5.7.32</code>ä¾èµ–<code>boost 1.59.0</code>: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -o boost_1_59_0.tar.gz https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;boost&#x2F;boost&#x2F;1.59.0&#x2F;boost_1_59_0.tar.gz </span><br><span class="line">#curl -o mysql-5.7.32.tar.gz https:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;Downloads&#x2F;MySQL-5.7&#x2F;mysql-5.7.32.tar.gz</span><br><span class="line">å¦‚æœæ‹‰å–ä¸åˆ°ä½¿ç”¨ä¸‹æ–¹ä¸‹è½½åœ°å€ ï¼š</span><br><span class="line">https:&#x2F;&#x2F;downloads.mysql.com&#x2F;archives&#x2F;community&#x2F;</span><br></pre></td></tr></table></figure><p>è§£å‹ä¸‹è½½çš„åŒ…: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># è¿›å…¥ä¸‹è½½çš„è·¯å¾„ </span><br><span class="line"># è§£å‹åˆ°&#x2F;usr&#x2F;local&#x2F;ç›®å½•</span><br><span class="line">tar -xzvf boost_1_59_0.tar.gz -C &#x2F;usr&#x2F;local&#x2F; </span><br><span class="line"># è§£å‹åˆ°å½“å‰ç›®å½• </span><br><span class="line">tar -xzvf mysql-5.7.32.tar.gz</span><br></pre></td></tr></table></figure><h1><span id="åˆ›å»ºç”¨æˆ·å’Œç»„">åˆ›å»ºç”¨æˆ·å’Œç»„</span></h1><p>åˆ›å»º<code>MySQL</code>ç”¨æˆ·å’Œç»„, å¹¶ä¸”ç”¨æˆ·ä¸èƒ½ç™»é™†: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -r mysql &amp;&amp; useradd -r -g mysql -s &#x2F;sbin&#x2F;nologin -M mysql </span><br></pre></td></tr></table></figure><h1><span id="åˆ›å»ºç›¸å…³çš„ç›®å½•">åˆ›å»ºç›¸å…³çš„ç›®å½•</span></h1><h3><span id="åˆ›å»ºæ•°æ®ç›®å½•">åˆ›å»ºæ•°æ®ç›®å½•</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p &#x2F;home&#x2F;mysql&#x2F;data</span><br><span class="line"></span><br><span class="line">mkdir -p &#x2F;home&#x2F;mysql&#x2F;logs</span><br><span class="line"></span><br><span class="line">mkdir -p &#x2F;usr&#x2F;local&#x2F;mysql </span><br><span class="line"></span><br><span class="line">mkdir -p &#x2F;home&#x2F;mysql&#x2F;temp</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chown -Rf mysql:mysql &#x2F;usr&#x2F;local&#x2F;mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">chown -Rf mysql:mysql &#x2F;home&#x2F;mysql</span><br></pre></td></tr></table></figure><h1><span id="é¢„ç¼–è¯‘">é¢„ç¼–è¯‘</span></h1><p>ä½¿ç”¨å„ç§å‚æ•°, é¢„ç¼–è¯‘æºä»£ç . è¿›å…¥è§£å‹çš„<code>MySQL</code>æºç ç›®å½•, æ‰§è¡Œä»¥ä¸‹å‘½ä»¤: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_INSTALL_PREFIX&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql -DMYSQL_DATADIR&#x3D;&#x2F;home&#x2F;mysql&#x2F;data -DSYSCONFDIR&#x3D;&#x2F;etc -DMYSQL_UNIX_ADDR&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysqld.sock -DEXTRA_CHARSETS&#x3D;all -DDEFAULT_CHARSET&#x3D;utf8mb4 -DDEFAULT_COLLATION&#x3D;utf8mb4_unicode_ci -DWITH_MYISAM_STORAGE_ENGINE&#x3D;1 -DWITH_INNOBASE_STORAGE_ENGINE&#x3D;1 -DWITH_PARTITION_STORAGE_ENGINE&#x3D;1 -DWITH_ARCHIVE_STORAGE_ENGINE&#x3D;1 -DWITH_BLACKHOLE_STORAGE_ENGINE&#x3D;1 -DENABLED_LOCAL_INFILE&#x3D;1 -DENABLED_PROFILING&#x3D;1 -DMYSQL_TCP_PORT&#x3D;3306 -DWITH_DEBUG&#x3D;0 -DDOWNLOAD_BOOST&#x3D;1 -DWITH_BOOST&#x3D;&#x2F;usr&#x2F;local&#x2F;boost_1_59_0</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DCMAKE_INSTALL_PREFIX&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql :å®‰è£…è·¯å¾„</span><br><span class="line">DMYSQL_DATADIR&#x3D;&#x2F;data&#x2F;mysql :æ•°æ®æ–‡ä»¶å­˜æ”¾ä½ç½®</span><br><span class="line">DSYSCONFDIR&#x3D;&#x2F;etc :my.cnfè·¯å¾„</span><br><span class="line">DMYSQL_UNIX_ADDR&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysqld.sock :è¿æ¥æ•°æ®åº“socketè·¯å¾„ </span><br><span class="line">DEXTRA_CHARSETS&#x3D;all :å®‰è£…æ‰€æœ‰çš„å­—ç¬¦é›†</span><br><span class="line">DDEFAULT_CHARSET&#x3D;utf8mb4 :é»˜è®¤å­—ç¬¦</span><br><span class="line">DDEFAULT_COLLATION&#x3D;utf8mb4_unicode_ci :æ’åºé›†</span><br><span class="line">DWITH_MYISAM_STORAGE_ENGINE&#x3D;1 :æ”¯æŒMyIASMå¼•æ“</span><br><span class="line">DWITH_INNOBASE_STORAGE_ENGINE&#x3D;1 :æ”¯æŒInnoDBå¼•æ“</span><br><span class="line">DWITH_PARTITION_STORAGE_ENGINE&#x3D;1 :å®‰è£…æ”¯æŒæ•°æ®åº“åˆ†åŒº</span><br><span class="line">DENABLED_LOCAL_INFILE&#x3D;1 :å…è®¸ä»æœ¬åœ°å¯¼å…¥æ•°æ®</span><br><span class="line">DENABLED_PROFILING&#x3D;1 :</span><br><span class="line">DMYSQL_TCP_PORT&#x3D;3306 :ç«¯å£</span><br><span class="line">DWITH_DEBUG&#x3D;0 :</span><br><span class="line">DDOWNLOAD_BOOST&#x3D;1 :å…è®¸ä¸‹è½½</span><br><span class="line">DWITH_BOOST&#x3D;&#x2F;usr&#x2F;local&#x2F;boost_1_59_0 :æœ¬åœ°boostè·¯å¾„ </span><br></pre></td></tr></table></figure><h1><span id="ç¼–è¯‘å®‰è£…">ç¼–è¯‘å®‰è£…</span></h1><p>é¢„ç¼–è¯‘å®Œæˆå, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ç¼–è¯‘, å®‰è£…: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŒ‡å®šCPUæ•°é‡ç¼–è¯‘ </span><br><span class="line">make -j &#96;grep processor &#x2F;proc&#x2F;cpuinfo | wc -l&#96; &amp;&amp; make install</span><br></pre></td></tr></table></figure><h1><span id="æ·»åŠ å¼€æœºè‡ªå¯">æ·»åŠ å¼€æœºè‡ªå¯</span></h1><p>å¯¹ç›®å½•ä¿®æ”¹æƒé™, æ·»åŠ <code>service/systemd</code>æœåŠ¡: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chown -R mysql:mysql &#x2F;usr&#x2F;local&#x2F;mysql </span><br><span class="line">cp &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;support-files&#x2F;mysql.server &#x2F;etc&#x2F;init.d&#x2F;mysql</span><br><span class="line">chmod +x &#x2F;etc&#x2F;init.d&#x2F;mysql</span><br><span class="line"># å¼€æœºè‡ªå¯ </span><br><span class="line">chkconfig --add mysql</span><br><span class="line">chkconfig mysql on </span><br></pre></td></tr></table></figure><h1><span id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</span></h1><p>å°†<code>/usr/local/mysql/bin</code>æ·»åŠ è¿›å…¥<code>ç¯å¢ƒå˜é‡</code>, æˆ–è€…ç›´æ¥ä½¿ç”¨<code>è½¯é“¾æ¥</code>çš„æ–¹å¼é“¾åˆ°<code>/usr/local/bin</code>ä¸‹: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ </span><br><span class="line">echo &quot;&quot; &gt;&gt; &#x2F;etc&#x2F;bashrc </span><br><span class="line">echo &quot;export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin:$PATH&quot; &gt;&gt; &#x2F;etc&#x2F;bashrc </span><br><span class="line">echo &quot;&quot; &gt;&gt; &#x2F;etc&#x2F;bashrc </span><br><span class="line">source ~&#x2F;.bashrc </span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨è½¯é“¾æ¥ </span><br><span class="line">ln -s &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;* &#x2F;usr&#x2F;local&#x2F;bin&#x2F;</span><br></pre></td></tr></table></figure><h1><span id="åˆå§‹åŒ–æ•°æ®åº“">åˆå§‹åŒ–æ•°æ®åº“</span></h1><p>ä»¥ä¸Šéƒ½å®Œæˆå, è¿˜ä¸èƒ½å¯åŠ¨MySQL, å¦‚æœéè¦å¯åŠ¨, ä¼šæŠ¥é”™. éœ€è¦åˆå§‹åŒ–æ•°æ®åº“:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;bin&#x2F;mysqld --initialize --user&#x3D;mysql --basedir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql --datadir&#x3D;&#x2F;home&#x2F;mysql&#x2F;data</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--user :æŒ‡å®šç”¨æˆ· </span><br><span class="line">--basedir :mysqlæ‰€åœ¨ç›®å½• </span><br><span class="line">--datadir :mysqlæ•°æ®åº“å’Œè¡¨æ‰€åœ¨çš„ç›®å½•,ä»¥åŠPIDæ–‡ä»¶ </span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–å, ä¼šæœ‰ä¸€è¡Œæç¤º, å†’å·åé¢çš„æ˜¯åˆå§‹å¯†ç <code>root@localhost: password</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A temporary password is generated for root@localhost: xKefZvib13)5 </span><br></pre></td></tr></table></figure><h1><span id="å¯åŠ¨æœåŠ¡">å¯åŠ¨æœåŠ¡</span></h1><p>ä»¥ä¸Šéƒ½é…ç½®å®Œæˆ, å°±å¯ä»¥å¯åŠ¨æœåŠ¡äº†: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨service </span><br><span class="line">service mysql start </span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨systemd </span><br><span class="line">systemctl daemon-reload </span><br><span class="line">systemctl start mysql</span><br></pre></td></tr></table></figure><h1><span id="ä¿®æ”¹å¯†ç ">ä¿®æ”¹å¯†ç </span></h1><p>å°†åˆå§‹å¯†ç ä¿®æ”¹æˆè‡ªå·±çš„å¯†ç , ç›´æ¥åœ¨<code>shell</code>ä¸­è¾“å…¥å‘½ä»¤: <code>mysqladmin -uroot -p&#39;old_pass&#39; password &#39;new_pass&#39;</code> </p><h1><span id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</span></h1><p>é»˜è®¤<code>MySQLä¸</code>éœ€è¦é…ç½®æ–‡ä»¶, ç¼–è¯‘æ—¶å·²ç»é…ç½®å¥½äº†, ä½†æ˜¯ä¹Ÿå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶, æŒ‡å®š<code>log</code>çš„ä½ç½®, ç¼–è¾‘<code>vim /etc/my.cnf</code>, å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶ä¸­:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line"></span><br><span class="line">port &#x3D; 3306</span><br><span class="line"></span><br><span class="line">socket &#x3D; &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysql.sock</span><br><span class="line"></span><br><span class="line">default-character-set&#x3D;utf8mb4</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set&#x3D;utf8mb4</span><br><span class="line">[mysqld]</span><br><span class="line"></span><br><span class="line">character-set-client-handshake&#x3D;FALSE</span><br><span class="line"></span><br><span class="line">character-set-server&#x3D;utf8mb4</span><br><span class="line"></span><br><span class="line">collation-server&#x3D;utf8mb4_unicode_ci</span><br><span class="line"></span><br><span class="line">init_connect&#x3D;&#39;SET NAMES utf8mb4&#39;</span><br><span class="line"></span><br><span class="line">#character-set-server &#x3D; utf8</span><br><span class="line"></span><br><span class="line">#collation-server &#x3D; utf8_general_ci</span><br><span class="line"></span><br><span class="line">skip-external-locking</span><br><span class="line"></span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line">user &#x3D; mysql</span><br><span class="line"></span><br><span class="line">port &#x3D; 3306</span><br><span class="line"></span><br><span class="line">basedir &#x3D; &#x2F;usr&#x2F;local&#x2F;mysql</span><br><span class="line"></span><br><span class="line">datadir &#x3D; &#x2F;home&#x2F;mysql&#x2F;data</span><br><span class="line"></span><br><span class="line">tmpdir &#x3D; &#x2F;home&#x2F;mysql&#x2F;temp</span><br><span class="line"></span><br><span class="line"># server_id &#x3D; .....</span><br><span class="line"></span><br><span class="line">socket &#x3D; &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;mysql.sock</span><br><span class="line"></span><br><span class="line">log-error &#x3D; &#x2F;home&#x2F;mysql&#x2F;logs&#x2F;mysql_error.log</span><br><span class="line"></span><br><span class="line">pid-file &#x3D; &#x2F;home&#x2F;mysql&#x2F;mysql.pid</span><br><span class="line"></span><br><span class="line">open_files_limit &#x3D; 10240</span><br><span class="line"></span><br><span class="line">back_log &#x3D; 600</span><br><span class="line"></span><br><span class="line">max_connections&#x3D;500</span><br><span class="line"></span><br><span class="line">max_connect_errors &#x3D; 6000</span><br><span class="line"></span><br><span class="line">wait_timeout&#x3D;605800</span><br><span class="line"></span><br><span class="line">#open_tables &#x3D; 600</span><br><span class="line"></span><br><span class="line">#table_cache &#x3D; 650</span><br><span class="line"></span><br><span class="line">#opened_tables &#x3D; 630</span><br><span class="line"></span><br><span class="line">max_allowed_packet &#x3D; 32M</span><br><span class="line"></span><br><span class="line">sort_buffer_size &#x3D; 4M</span><br><span class="line"></span><br><span class="line">join_buffer_size &#x3D; 4M</span><br><span class="line"></span><br><span class="line">thread_cache_size &#x3D; 300</span><br><span class="line"></span><br><span class="line">query_cache_type &#x3D; 1</span><br><span class="line"></span><br><span class="line">query_cache_size &#x3D; 256M</span><br><span class="line"></span><br><span class="line">query_cache_limit &#x3D; 2M</span><br><span class="line"></span><br><span class="line">query_cache_min_res_unit &#x3D; 16k</span><br><span class="line"></span><br><span class="line">tmp_table_size &#x3D; 256M</span><br><span class="line"></span><br><span class="line">max_heap_table_size &#x3D; 256M</span><br><span class="line"></span><br><span class="line">key_buffer_size &#x3D; 256M</span><br><span class="line"></span><br><span class="line">read_buffer_size &#x3D; 1M</span><br><span class="line"></span><br><span class="line">read_rnd_buffer_size &#x3D; 16M</span><br><span class="line"></span><br><span class="line">bulk_insert_buffer_size &#x3D; 64M</span><br><span class="line"></span><br><span class="line">lower_case_table_names&#x3D;1</span><br><span class="line"></span><br><span class="line">default-storage-engine &#x3D; INNODB</span><br><span class="line"></span><br><span class="line">innodb_buffer_pool_size &#x3D;2G</span><br><span class="line"></span><br><span class="line">innodb_log_buffer_size &#x3D; 32M</span><br><span class="line"></span><br><span class="line">innodb_log_file_size &#x3D; 128M</span><br><span class="line"></span><br><span class="line">innodb_flush_method &#x3D;O_DIRECT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#####################</span><br><span class="line"></span><br><span class="line">#thread_concurrency &#x3D; 32 5.7ä¸æ”¯æŒ</span><br><span class="line"></span><br><span class="line">long_query_time&#x3D; 2</span><br><span class="line"></span><br><span class="line">slow-query-log&#x3D;on</span><br><span class="line"></span><br><span class="line">slow-query-log-file &#x3D;&#x2F;home&#x2F;mysql&#x2F;logs&#x2F;mysql-slow.log</span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line"></span><br><span class="line">quick</span><br><span class="line"></span><br><span class="line">max_allowed_packet &#x3D; 32M</span><br><span class="line"></span><br><span class="line">[mysqld_safe]</span><br><span class="line"></span><br><span class="line">log-error&#x3D;&#x2F;var&#x2F;log&#x2F;mysqld.log</span><br><span class="line"></span><br><span class="line">pid-file&#x3D;&#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.pid</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;mysqlç¼–è¯‘å’Œå®‰è£…&quot;&gt;MySQLç¼–è¯‘å’Œå®‰è£…&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;##åœ¨&lt;code&gt;CentOS7&lt;/code&gt;ä¸­ç¼–è¯‘å®‰è£…&lt;code&gt;MySQL 5.7.21&lt;/code&gt;. ä¾èµ–å’Œæºç åŒ… å®‰è£…ç›¸å…³çš„ä¾èµ–: &lt;/p&gt;
&lt;figure class</summary>
      
    
    
    
    <category term="Mysql" scheme="https://imszz.com/categories/Mysql/"/>
    
    
    <category term="mysql" scheme="https://imszz.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>mysqlæ•°æ®æ›´æ”¹å­˜å‚¨è·¯å¾„</title>
    <link href="https://imszz.com/p/57aae221/"/>
    <id>https://imszz.com/p/57aae221/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2021-01-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨åˆæ¬¡å®‰è£…mysql çš„æ—¶å€™å°†æ•°æ®åº“ç›®å½•å®‰è£…åœ¨äº†ç³»ç»Ÿç›˜ã€‚ï¼ˆç¬¬ä¸€ä¸ªç£ç›˜ï¼‰ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´ä¹‹åæ•°æ®åº“å­˜å‚¨é‡å˜å¤§ï¼Œå¿«å°†20GBçš„å­˜æ”¾ç©ºé—´å æ»¡äº†ã€‚å› æ­¤å¿…é¡»å°†å­˜æ”¾æ•°æ®ç©ºé—´æ¢åœ°æ–¹äº†ã€‚ä¸‹é¢æ˜¯ç®€å•çš„æ“ä½œã€‚</p></blockquote><h1><span id="æ“ä½œæ­¥éª¤">æ“ä½œæ­¥éª¤ï¼š</span></h1><h2><span id="1æ£€æŸ¥mysqlæ•°æ®åº“å­˜æ”¾ç›®å½•">1.æ£€æŸ¥mysqlæ•°æ®åº“å­˜æ”¾ç›®å½•</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -prootadmin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#è¿›å…¥æ•°æ®åº“</span><br><span class="line"></span><br><span class="line">show variables like &#39;%dir%&#39;;</span><br><span class="line"></span><br><span class="line">#æŸ¥çœ‹sqlå­˜å‚¨è·¯å¾„</span><br><span class="line"></span><br><span class="line">ï¼ˆæŸ¥çœ‹datadir é‚£ä¸€è¡Œæ‰€æŒ‡çš„è·¯å¾„ï¼‰</span><br><span class="line"></span><br><span class="line">quit;</span><br></pre></td></tr></table></figure><h2><span id="2åœæ­¢mysqlæœåŠ¡">2.åœæ­¢mysqlæœåŠ¡</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql stop</span><br></pre></td></tr></table></figure><h2><span id="3åˆ›å»ºæ–°çš„æ•°æ®åº“å­˜æ”¾ç›®å½•">3.åˆ›å»ºæ–°çš„æ•°æ®åº“å­˜æ”¾ç›®å½•</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#x2F;data&#x2F;mysql</span><br></pre></td></tr></table></figure><h2><span id="4ç§»åŠ¨å¤åˆ¶ä¹‹å‰å­˜æ”¾æ•°æ®åº“ç›®å½•æ–‡ä»¶åˆ°æ–°çš„æ•°æ®åº“å­˜æ”¾ç›®å½•ä½ç½®">4.ç§»åŠ¨/å¤åˆ¶ä¹‹å‰å­˜æ”¾æ•°æ®åº“ç›®å½•æ–‡ä»¶ï¼Œåˆ°æ–°çš„æ•°æ®åº“å­˜æ”¾ç›®å½•ä½ç½®</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp -R &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data&#x2F;* &#x2F;data&#x2F;mysql&#x2F; #æˆ–mv &#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data&#x2F;* &#x2F;data&#x2F;mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="5ä¿®æ”¹mysqlæ•°æ®åº“ç›®å½•æƒé™ä»¥åŠé…ç½®æ–‡ä»¶">5.ä¿®æ”¹mysqlæ•°æ®åº“ç›®å½•æƒé™ä»¥åŠé…ç½®æ–‡ä»¶</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">chown mysql:mysql -R &#x2F;data&#x2F;mysql&#x2F;</span><br><span class="line"></span><br><span class="line">vim &#x2F;etc&#x2F;my.cnf</span><br><span class="line"></span><br><span class="line">datadir&#x3D;&#x2F;data&#x2F;mysql ï¼ˆåˆ¶å®šä¸ºæ–°çš„æ•°æ®å­˜æ”¾ç›®å½•ï¼‰</span><br><span class="line"></span><br><span class="line">vim &#x2F;etc&#x2F;init.d&#x2F;mysql</span><br><span class="line"></span><br><span class="line">datadir&#x3D;&#x2F;data&#x2F;mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2><span id="6å¯åŠ¨æ•°æ®åº“æœåŠ¡">6.å¯åŠ¨æ•°æ®åº“æœåŠ¡</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šæ ¹æ®ä»¥ä¸Šçš„ç®€å•6æ­¥æ“ä½œï¼Œå·²ç»æˆåŠŸçš„æ•°æ®åº“ç›®å½•æ›´æ¢è·¯å¾„äº†ã€‚</p><blockquote><p>å¤‡æ³¨ï¼šä»¥ä¸Šç³»ç»Ÿä¸ºCentOS Linux release 7.8.2003 (Core)  mysql-5.7.32 ç¼–è¯‘å®‰è£…</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;åœ¨åˆæ¬¡å®‰è£…mysql çš„æ—¶å€™å°†æ•°æ®åº“ç›®å½•å®‰è£…åœ¨äº†ç³»ç»Ÿç›˜ã€‚ï¼ˆç¬¬ä¸€ä¸ªç£ç›˜ï¼‰ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´ä¹‹åæ•°æ®åº“å­˜å‚¨é‡å˜å¤§ï¼Œå¿«å°†20GBçš„å­˜æ”¾ç©ºé—´å æ»¡äº†ã€‚å› æ­¤å¿…é¡»å°†å­˜æ”¾æ•°æ®ç©ºé—´æ¢åœ°æ–¹äº†ã€‚ä¸‹é¢æ˜¯ç®€å•çš„æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;&lt;span id</summary>
      
    
    
    
    <category term="Mysql" scheme="https://imszz.com/categories/Mysql/"/>
    
    
    <category term="mysql" scheme="https://imszz.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>æŸ¥çœ‹LINUXå‘è¡Œç‰ˆçš„åç§°åŠå…¶ç‰ˆæœ¬å·</title>
    <link href="https://imszz.com/p/2399c152/"/>
    <id>https://imszz.com/p/2399c152/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2021-01-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>æŸ¥çœ‹LINUXå‘è¡Œç‰ˆçš„åç§°åŠå…¶ç‰ˆæœ¬å·çš„å‘½ä»¤,è¿™äº›ä¿¡æ¯å¯¹äºæ·»åŠ æ­£ç¡®çš„è½¯ä»¶æ›´æ–°æºå¾ˆæœ‰ç”¨ï¼Œè€Œå½“ä½ åªèƒ½åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ—¶å€™ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥å¸®å¿™ã€‚</p><h2><span id="ä¸€-æŸ¥çœ‹linuxå†…æ ¸ç‰ˆæœ¬å‘½ä»¤ä¸¤ç§æ–¹æ³•">ä¸€ã€æŸ¥çœ‹Linuxå†…æ ¸ç‰ˆæœ¬å‘½ä»¤ï¼ˆä¸¤ç§æ–¹æ³•ï¼‰ï¼š</span></h2><p>1ã€<code>cat /proc/version</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat &#x2F;proc&#x2F;version</span><br><span class="line">Linux version 2.6.18-194.8.1.el5.centos.plus</span><br><span class="line">(mockbuild@builder17.centos.org) (gcc version 4.1.220080704</span><br><span class="line">(Red Hat 4.1.2-48)) #1 SMP Wed Jul 7 11:50:45 EDT 2010</span><br></pre></td></tr></table></figure><p>2ã€<code>uname -a</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# uname -a</span><br><span class="line">Linux localhost.localdomain 2.6.18-194.8.1.el5.centos.plus </span><br><span class="line">#1 SMP Wed Jul 7 11:50:45 EDT 2010 i686 i686 i386 GNU&#x2F;Linux</span><br></pre></td></tr></table></figure><h2><span id="äºŒ-æŸ¥çœ‹linuxç³»ç»Ÿç‰ˆæœ¬çš„å‘½ä»¤3ç§æ–¹æ³•">äºŒã€æŸ¥çœ‹Linuxç³»ç»Ÿç‰ˆæœ¬çš„å‘½ä»¤ï¼ˆ3ç§æ–¹æ³•ï¼‰ï¼š</span></h2><p>1ã€<code>lsb_release -a</code>ï¼Œå³å¯åˆ—å‡ºæ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# lsb_release -a</span><br><span class="line">LSB Version: :core-3.1-ia32:core-3.1-noarch:graphics-3.1-ia32:graphics-3.1-noarch</span><br><span class="line">Distributor ID: CentOS</span><br><span class="line">Description: CentOS release 6.5 (Final)</span><br><span class="line">Release: 6.5</span><br><span class="line">Codename: Final</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤é€‚ç”¨äºæ‰€æœ‰çš„Linuxå‘è¡Œç‰ˆï¼ŒåŒ…æ‹¬Redhatã€SuSEã€Debianâ€¦ç­‰å‘è¡Œç‰ˆã€‚</p><p>2ã€<code>cat /etc/redhat-release</code>ï¼Œè¿™ç§æ–¹æ³•åªé€‚åˆRedhatç³»çš„Linuxï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat &#x2F;etc&#x2F;redhat-release</span><br><span class="line">CentOS release 6.7 (Final)</span><br></pre></td></tr></table></figure><p>3ã€<code>cat /etc/issue</code>ï¼Œæ­¤å‘½ä»¤ä¹Ÿé€‚ç”¨äºæ‰€æœ‰çš„Linuxå‘è¡Œç‰ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat &#x2F;etc&#x2F;issue</span><br><span class="line">CentOS release 6.7 (Final)</span><br><span class="line">Kernel \r on an \m</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æŸ¥çœ‹LINUXå‘è¡Œç‰ˆçš„åç§°åŠå…¶ç‰ˆæœ¬å·çš„å‘½ä»¤,è¿™äº›ä¿¡æ¯å¯¹äºæ·»åŠ æ­£ç¡®çš„è½¯ä»¶æ›´æ–°æºå¾ˆæœ‰ç”¨ï¼Œè€Œå½“ä½ åªèƒ½åœ¨å‘½ä»¤è¡Œä¸‹å·¥ä½œçš„æ—¶å€™ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥å¸®å¿™ã€‚&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;ä¸€-æŸ¥çœ‹linuxå†…æ ¸ç‰ˆæœ¬å‘½ä»¤ä¸¤ç§æ–¹æ³•&quot;&gt;ä¸€ã€æŸ¥çœ‹Linuxå†…æ ¸ç‰ˆæœ¬å‘½ä»¤ï¼ˆä¸¤ç§æ–¹æ³•ï¼‰ï¼š&lt;/span&gt;</summary>
      
    
    
    
    <category term="linux" scheme="https://imszz.com/categories/linux/"/>
    
    
    <category term="linux" scheme="https://imszz.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³githubå›¾ç‰‡ä¸æ˜¾ç¤ºé—®é¢˜</title>
    <link href="https://imszz.com/p/32e6fc54/"/>
    <id>https://imszz.com/p/32e6fc54/</id>
    <published>2021-01-13T16:00:00.000Z</published>
    <updated>2021-01-14T02:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¿®æ”¹hosts</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Windows</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\drivers\etc\hosts</span><br><span class="line"></span><br><span class="line">Mac</span><br><span class="line"></span><br><span class="line">vim &#x2F;etc&#x2F;hosts</span><br></pre></td></tr></table></figure><p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># GitHub Start </span><br><span class="line">192.30.253.112    Build software better, together </span><br><span class="line">192.30.253.119    gist.github.com</span><br><span class="line">151.101.184.133    assets-cdn.github.com</span><br><span class="line">151.101.184.133    raw.githubusercontent.com</span><br><span class="line">151.101.184.133    gist.githubusercontent.com</span><br><span class="line">151.101.184.133    cloud.githubusercontent.com</span><br><span class="line">151.101.184.133    camo.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars0.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars1.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars2.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars3.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars4.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars5.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars6.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars7.githubusercontent.com</span><br><span class="line">151.101.184.133    avatars8.githubusercontent.com</span><br><span class="line"></span><br><span class="line"># GitHub End</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¿®æ”¹hosts&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;</summary>
      
    
    
    
    <category term="Github" scheme="https://imszz.com/categories/Github/"/>
    
    
    <category term="Github" scheme="https://imszz.com/tags/Github/"/>
    
  </entry>
  
  <entry>
    <title>GitHub å›¾åºŠçš„æ­£ç¡®ç”¨æ³•ï¼Œé€šè¿‡ jsDelivr CDN å…¨çƒåŠ é€Ÿ</title>
    <link href="https://imszz.com/p/7fa69db0/"/>
    <id>https://imszz.com/p/7fa69db0/</id>
    <published>2021-01-13T12:46:25.000Z</published>
    <updated>2021-01-13T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ›å»ºä¸€ä¸ª GitHub å…¬å…±ä»“åº“ä½œä¸ºå›¾åºŠä»“åº“ï¼Œä¸Šä¼ æäº¤å›¾ç‰‡åˆ°ä»“åº“ä¸­</p><p>åœ¨è¦ä½¿ç”¨ GitHub å›¾åºŠå›¾ç‰‡çš„åœ°æ–¹å°†é“¾æ¥æ¢ä¸º </p><div class="note primary no-icon"><p><a href="https://cdn.jsdelivr.net/gh/%7Buser%7D/%7Brepo%7D/%E5%9B%BE%E7%89%87%E8%B7%AF%E5%BE%84">https://cdn.jsdelivr.net/gh/{user}/{repo}/å›¾ç‰‡è·¯å¾„</a></p></div><p>ä¸¾ä¸ªæ —å­</p><p>æ¯”å¦‚ GitHub å®˜æ–¹ä»“åº“ <code>github/explore</code> ä¸‹è¯é¢˜ GitHub å›¾ç‰‡åŸå§‹è·¯å¾„æ˜¯ï¼š</p><div class="note default"><p><a href="https://github.com/weilain/cdn-photo/blob/main/banner/bannar.jpg">https://github.com/weilain/cdn-photo/blob/main/banner/bannar.jpg</a></p></div><p>è®¿é—®èµ·æ¥è´¼æ…¢ã€‚</p><p>ä½¿ç”¨ jsDelivr åŠ é€Ÿåçš„åœ°å€ï¼š</p><div class="note success"><p><a href="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/banner/bannar.jpg">https://cdn.jsdelivr.net/gh/weilain/cdn-photo/banner/bannar.jpg</a> </p></div><p>è®¿é—®é€Ÿåº¦é£èµ·ï¼Œäº«å— <code>jsDelivr</code> æä¾›çš„å…¨çƒ <code>CDN</code> åŠ é€Ÿã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/jsdelivr-sdy8y2.png" alt="github--lena"></p><p>hexo å†…å®¹ markdown å†™æ³•</p><p>æ–‡ç« å†…å¼•ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![github--lena](https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;weilain&#x2F;cdn-photo&#x2F;img&#x2F;3xuci.gif)</span><br></pre></td></tr></table></figure><p>å°é¢å¼•ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cover: &#39;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;weilain&#x2F;cdn-photo&#x2F;covers&#x2F;gitlab2.png&#39;</span><br></pre></td></tr></table></figure><p>jsDelivr è¿˜æ”¯æŒåŠ è½½æŒ‡å®šæ–‡ä»¶ç‰ˆæœ¬å’Œè‡ªåŠ¨å‹ç¼© JSï¼Œå…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ<a href="https://www.jsdelivr.com/features?utm_source=ld246.com#gh">å®˜æ–¹æ•™ç¨‹</a>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åˆ›å»ºä¸€ä¸ª GitHub å…¬å…±ä»“åº“ä½œä¸ºå›¾åºŠä»“åº“ï¼Œä¸Šä¼ æäº¤å›¾ç‰‡åˆ°ä»“åº“ä¸­&lt;/p&gt;
&lt;p&gt;åœ¨è¦ä½¿ç”¨ GitHub å›¾åºŠå›¾ç‰‡çš„åœ°æ–¹å°†é“¾æ¥æ¢ä¸º &lt;/p&gt;
&lt;div class=&quot;note primary no-icon&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://cdn.jsdelivr</summary>
      
    
    
    
    <category term="Github" scheme="https://imszz.com/categories/Github/"/>
    
    
    <category term="jsDelivr" scheme="https://imszz.com/tags/jsDelivr/"/>
    
    <category term="CDN" scheme="https://imszz.com/tags/CDN/"/>
    
  </entry>
  
  <entry>
    <title>google-authenticator</title>
    <link href="https://imszz.com/p/6b915d25/"/>
    <id>https://imszz.com/p/6b915d25/</id>
    <published>2020-11-28T12:46:25.000Z</published>
    <updated>2020-11-29T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>å®‰è£…æ–¹å¼ä¸€ï¼š<br>Liunx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install epel-release</span><br><span class="line">yum -y install google-authenticator </span><br></pre></td></tr></table></figure><p>ubuntu</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo add-apt-repository universe</span><br><span class="line">sudo apt install libpam-google-authenticator</span><br></pre></td></tr></table></figure><p>å®‰è£…æ–¹å¼äºŒï¼š<br>Liunx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y git make gcc libtool pam-devel qrencode ntpdate</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;google-authenticator-libpam.git</span><br><span class="line">cd   google-authenticator-libpam&#x2F;</span><br><span class="line">.&#x2F;bootstrap.sh</span><br><span class="line">.&#x2F;configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>ubuntu</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get  -y install autoconf  git make gcc libtool libpam0g-dev qrencode ntpdate</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;google&#x2F;google-authenticator-libpam.git</span><br><span class="line">cd   google-authenticator-libpam&#x2F;</span><br><span class="line">.&#x2F;bootstrap.sh</span><br><span class="line">.&#x2F;configure</span><br><span class="line">sudo make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>é…ç½®ssh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config    #ubuntu   sudo</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å¦‚ä¸‹çš„é…ç½®é¡¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ChallengeResponseAuthentication yes</span><br><span class="line">UsePAM yes</span><br></pre></td></tr></table></figure><p>é…ç½®PAM</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;pam.d&#x2F;sshd      #ubuntu   sudo</span><br></pre></td></tr></table></figure><p>Liunx</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#%PAM-1.0</span><br><span class="line">auth      required     pam_google_authenticator.so   #æ·»åŠ è‡³ç¬¬ä¸€è¡Œ</span><br></pre></td></tr></table></figure><p>ubuntu</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth      required      pam_google_authenticator.so       #æœ«å°¾æ·»åŠ </span><br></pre></td></tr></table></figure><p>é‡å¯ssh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd     #ubuntu   sudo</span><br></pre></td></tr></table></figure><p>é…ç½®google authenticator<br>é¦–è¦æ¡ä»¶ï¼šå…ˆåˆ‡æ¢åˆ°ä½ éœ€è¦è®¾ç½®çš„å¸å· </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">google-authenticator</span><br></pre></td></tr></table></figure><pre><code>Do you want authentication tokens to be time-based (y/n)  #åŸºäºæ—¶é—´ç”Ÿæˆèº«ä»½éªŒè¯#å·²ç»å®‰è£…qrencodeä¼šäº§ç”Ÿä¸€ä¸ªäºŒç»´ç ï¼ŒäºŒç»´ç è¿æ¥ä¹Ÿå¯ä»¥URLæ˜¾ç¤ºYour new secret key is ï¼š***********   # å¯†é’¥keyYour verification code is : #code åŠ¨æ€ç Your emergency scratch codes are:  #  ç”Ÿæˆ5 ä¸ªç´§æ€¥æ•‘åŠ©ç Do you want me to update your &quot;/root/.google_authenticator&quot; file? (y/n)  #ä¸€ç›´ç¡®è®¤ä¸‹å»# ç”Ÿæˆäº†ä¸€ä¸ª .google_authenticator æ–‡ä»¶your chances to notice or even prevent man-in-the-middle attacks (y/n)  #ä¸€ç›´ç¡®è®¤ä¸‹å»Do you want to do so? (y/n)   #ä¸€ç›´ç¡®è®¤ä¸‹å»Do you want to enable rate-limiting? (y/n)  #è®¾ç½®å®Œæˆ#ä¸Šé¢çš„æ„æ€å¤§æ¦‚ä¸ºï¼šç¦æ­¢å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„èº«ä»½éªŒè¯ï¼Œé™åˆ¶æ¯30ç§’ç™»å½•ä¸€æ¬¡ï¼Œç§»åŠ¨ç«¯æ¯30ç§’æ›´æ–°ä¸€æ¬¡ï¼Œç§»åŠ¨ç«¯å’Œå®¢æˆ·ç«¯æ—¶é—´è¯¯å·®30ç§’ï¼Œ30ç§’å†…ä¸èƒ½è¶…è¿‡3æ¬¡ç™»å½•ã€‚</code></pre><p>å¦‚æœéœ€è¦åˆ é™¤ä¸€ä¸ªç”¨æˆ·çš„GoogleéªŒè¯ï¼Œåˆ é™¤è¿™ä¸ªç”¨æˆ·ä¸‹äº§ç”Ÿçš„<code>home/.google_authenticator</code>æ–‡ä»¶å³å¯</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å®‰è£…æ–¹å¼ä¸€ï¼š&lt;br&gt;Liunx&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;</summary>
      
    
    
    
    <category term="å¥‡æ€ªçš„çŸ¥è¯†ç‚¹" scheme="https://imszz.com/categories/%E5%A5%87%E6%80%AA%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    
    
    <category term="google" scheme="https://imszz.com/tags/google/"/>
    
    <category term="authenticator" scheme="https://imszz.com/tags/authenticator/"/>
    
  </entry>
  
  <entry>
    <title>awkå’Œsedæˆªå–nginxå’Œtomcatæ—¶é—´æ®µæ—¥å¿—</title>
    <link href="https://imszz.com/p/31397f6f/"/>
    <id>https://imszz.com/p/31397f6f/</id>
    <published>2020-11-25T12:46:25.000Z</published>
    <updated>2020-11-26T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h4><span id="nginxæ—¥å¿—æˆªå–ç¤ºä¾‹">nginxæ—¥å¿—æˆªå–ç¤ºä¾‹</span></h4><p>æ—¥å¿—è·¯å¾„ï¼š/usr/local/nginx/logs, æˆªå–access.logä¸­2019å¹´3æœˆ24æ—¥17ç‚¹00~02ä¹‹é—´çš„æ—¥å¿—ï¼š<br>ã€€å†™æ³•1ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log | awk &#39;$4 &gt;&#x3D;&quot;[24&#x2F;Mar&#x2F;2019:17:00:00&quot; &amp;&amp; $4 &lt;&#x3D;&quot;[24&#x2F;Mar&#x2F;2019:17:02:00&quot;&#39;</span><br></pre></td></tr></table></figure><p>ã€€å†™æ³•2ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log | egrep &quot;24&#x2F;Mar&#x2F;2019&quot; | awk -F&#39;:&#39; &#39;$2 &#x3D; 17 &amp;&amp; $3 &gt;&#x3D; 00 &amp;&amp; $3 &lt;&#x3D; 02&#39;</span><br></pre></td></tr></table></figure><p>ã€€å†™æ³•3ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log |egrep &quot;24&#x2F;Mar&#x2F;2019&quot; |sed -n &#39;&#x2F;17:00:00&#x2F;,&#x2F;17:02:00&#x2F;p&#39;</span><br></pre></td></tr></table></figure><h4><span id="tomcatæ—¥å¿—æˆªå–ç¤ºä¾‹">tomcatæ—¥å¿—æˆªå–ç¤ºä¾‹</span></h4><p>æ—¥å¿—è·¯å¾„ï¼š/usr/local/tomcat/logs, æˆªå–catalina.outä¸­2019å¹´3æœˆ24æ—¥17ç‚¹00~02ä¹‹é—´çš„æ—¥å¿—ï¼š<br>    å†™æ³•1ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#39;&#x2F;2019-03-24 17:00:&#x2F;,&#x2F;2019-03-24 17:02:&#x2F;p&#39;  catalina.out</span><br></pre></td></tr></table></figure><p>  å†™æ³•2ï¼š<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat catalina.out| egrep &quot;2019-03-24&quot; | awk -F&#39;:&#39; &#39;$2 &#x3D; 17 &amp;&amp; $3 &gt;&#x3D; 00 &amp;&amp; $3 &lt;&#x3D; 02&#39;</span><br></pre></td></tr></table></figure></p><h4><span id="awkç»Ÿè®¡nginxæ—¥å¿—çš„ipè®¿é—®é‡">awkç»Ÿè®¡nginxæ—¥å¿—çš„ipè®¿é—®é‡</span></h4><pre><code>nginxæ—¥å¿—äº‹å…ˆæˆªå–ä¸€éƒ¨åˆ†ï¼štail -n500 access.log &gt;access.log1</code></pre><p>ç¬¬ä¸€ç§ï¼šä½¿ç”¨awk sortï¼Œ$1è¡¨ç¤ºä»¥ç©ºæ ¼ä¸ºåˆ†å‰²ç¬¦çš„ç¬¬ä¸€åˆ—ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶ä¸­çš„ipåœ°å€ï¼Œä½¿ç”¨sortå¯¹ç»“æœæ’åºï¼Œuniq -cè¿›è¡Œè®¡æ•°ï¼Œæœ€åsort -næ˜¯ä»¥â€œæ•°å­—â€æ¥æ’åºï¼Œé’ˆå¯¹ç»Ÿè®¡åçš„è®¿é—®æ¬¡æ•°æ¥æ’åº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#39;&#123;print $1&#125;&#39; access.log1|sort |uniq -c|sort -n</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§ï¼šawk for,å³æ•°ç»„; é»˜è®¤å˜é‡ä¸º0ï¼Œå¯¹æ¯ä¸€è¡Œçš„$1ä½œä¸ºkeyï¼Œcountæ•°ç»„++ï¼Œå®ç°ipçš„è®¡æ•°ã€‚è®¡æ•°ç»“æŸåENDã€‚ç„¶åæŠŠç»“æœæ‰“å°å‡ºæ¥ï¼Œæœ€åsort -nä»¥â€œæ•°å­—â€æ’åºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#39;&#123;count[$1]++;&#125;END&#123;for(i in count)&#123;printf(&quot;%s\t%s\n&quot;, count[i], i);&#125;&#125;&#39; access.log1|sort -n</span><br></pre></td></tr></table></figure><h4><span id="å–nginxæ—¥å¿—è®¿é—®æ¥å£æ¬¡æ•°">å–nginxæ—¥å¿—è®¿é—®æ¥å£æ¬¡æ•°</span></h4><p>é€šè¿‡ä¸Šé¢çš„æ–¹æ³•å°†æŸä¸ªæ—¶é—´æ®µæ—¥å¿—å–å‡ºæ¥ï¼ŒæŸ¥è¯¢è¯¥æ—¶é—´æ®µè®¿é—®æ¥å£æœ€å¤šçš„å‰10ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"> #ç»Ÿè®¡æ¥å£çš„è®¿é—®æ¬¡æ•°</span><br><span class="line"> TODAY&#x3D;&#96;date +%d&#x2F;%b&#x2F;%Y&#96;</span><br><span class="line"> cat $1 |awk -F &#39;&quot;&#39; &#39;&#123;print $2&#125;&#39;|awk &#39;&#123;split($2,res,&quot;?&quot;) ; print res[1] &#125;&#39;|sort|uniq -c|sort -gr |head -n10</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4&gt;&lt;span id=&quot;nginxæ—¥å¿—æˆªå–ç¤ºä¾‹&quot;&gt;nginxæ—¥å¿—æˆªå–ç¤ºä¾‹&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;æ—¥å¿—è·¯å¾„ï¼š/usr/local/nginx/logs, æˆªå–access.logä¸­2019å¹´3æœˆ24æ—¥17ç‚¹00~02ä¹‹é—´çš„æ—¥å¿—ï¼š&lt;br&gt;ã€€å†™æ³•1ï¼š&lt;/p&gt;
&lt;figure </summary>
      
    
    
    
    <category term="Nginx" scheme="https://imszz.com/categories/Nginx/"/>
    
    <category term="linux" scheme="https://imszz.com/categories/Nginx/linux/"/>
    
    
    <category term="awk" scheme="https://imszz.com/tags/awk/"/>
    
    <category term="sed" scheme="https://imszz.com/tags/sed/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•æ³¨å†Œè°·æ­Œè´¦å·ï¼Œé‡åˆ°â€œæ­¤ç”µè¯å·ç æ— æ³•ç”¨äºè¿›è¡ŒéªŒè¯â€æ€ä¹ˆåŠ</title>
    <link href="https://imszz.com/p/4b638dc2/"/>
    <id>https://imszz.com/p/4b638dc2/</id>
    <published>2020-10-25T13:25:23.000Z</published>
    <updated>2020-10-29T13:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="ç¬¬1æ­¥æ‰¾åˆ°è°·æ­Œè´¦å·æ³¨å†Œå…¥å£">ç¬¬1æ­¥ï¼šæ‰¾åˆ°è°·æ­Œè´¦å·æ³¨å†Œå…¥å£</span></h1><p>æ‰“å¼€Googleï¼Œåœ¨è°·æ­Œæœç´¢çš„ä¸»ç•Œé¢ï¼Œæ‰¾åˆ°å³ä¸Šè§’çš„ç™»å½•è´¦å·æŒ‰é’®ã€‚æˆ‘è¿™é‡Œæµè§ˆå™¨è¯­è¨€æ˜¯ä¸­æ–‡çš„ï¼Œæ‰€ä»¥æ˜¯æ˜¾ç¤ºä¸­æ–‡ï¼Œå¦‚æœæ˜¯é»˜è®¤è‹±æ–‡è¯­è¨€çš„æµè§ˆå™¨ï¼Œæ‰“å¼€å°±ä¼šæ˜¾ç¤ºè‹±æ–‡ï¼Œä½†æŒ‰é’®ä½ç½®æ˜¯ç›¸åŒçš„ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-1.png" alt="github--lena"></p><p>ç‚¹å‡»â€œç™»å½•â€æŒ‰é’®åï¼Œåœ¨æ–°è·³è½¬çš„é¡µé¢ç‚¹å‡»â€œåˆ›å»ºè´¦å·â€<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-2.png" alt="github--lena"><br>æ²¡æœ‰ç‰¹åˆ«éœ€æ±‚ï¼Œç‚¹å‡»â€œä¸ºæˆ‘è‡ªå·±åˆ›å»ºâ€å³å¯ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-3.png" alt="github--lena"></p><h1><span id="ç¬¬2æ­¥å¡«å†™è°·æ­Œè´¦å·ç”³è¯·èµ„æ–™">ç¬¬2æ­¥ï¼šå¡«å†™è°·æ­Œè´¦å·ç”³è¯·èµ„æ–™</span></h1><p>æŒ‰æç¤ºè¦æ±‚ï¼Œå¡«å†™ç›¸åº”çš„è´¦å·èµ„æ–™ï¼Œå¡«å†™å®Œæˆåï¼Œç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-4.png" alt="github--lena"></p><h1><span id="ç¬¬3æ­¥éªŒè¯æ‰‹æœºå·ç ">ç¬¬3æ­¥ï¼šéªŒè¯æ‰‹æœºå·ç </span></h1><p>ä¸ºäº†é˜²æ­¢æ»¥ç”¨ä»¥åŠä¿æŠ¤è´¦å·å®‰å…¨ï¼ŒGoogleè´¦å·éœ€è¦ç»‘å®šä½ çš„æ‰‹æœºå·ç ï¼Œç‚¹å‡»å›½æ——ä½ç½®ï¼Œå¯ä»¥åˆ‡æ¢åˆ°ä¸åŒå›½å®¶åœ°åŒºã€‚æ ¹æ®è‡ªèº«æ‰‹æœºå·ç æ‰€åœ¨åœ°åŒºï¼Œåˆ‡æ¢åˆ°å¯¹åº”çš„å›½å®¶ä½ç½®ï¼Œç„¶åå¡«å†™æ‰‹æœºå·ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥éªŒè¯ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-5.png" alt="github--lena"></p><h1><span id="ç¬¬4æ­¥é‡åˆ°æ­¤ç”µè¯å·ç æ— æ³•ç”¨äºè¿›è¡ŒéªŒè¯è¯¥æ€ä¹ˆåŠ">ç¬¬4æ­¥ï¼šé‡åˆ°â€œæ­¤ç”µè¯å·ç æ— æ³•ç”¨äºè¿›è¡ŒéªŒè¯â€è¯¥æ€ä¹ˆåŠ</span></h1><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-6.png" alt="github--lena"><br>å·ç æ— æ³•éªŒè¯ï¼Œå°±æ— æ³•å®Œæˆè´¦å·çš„æ³¨å†Œã€‚ç»è¿‡å¤šæ¬¡æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªé—®é¢˜è·Ÿæµè§ˆå™¨çš„è¯­è¨€è®¾ç½®æœ‰å…³ç³»ã€‚è¯­è¨€è®¾ç½®ä¸ºä¸­æ–‡çš„æµè§ˆå™¨ï¼Œå°±ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚è§£å†³çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œä»¥è°·æ­ŒChromeæµè§ˆå™¨ä¸ºä¾‹ï¼Œæˆ‘ä»¬çœ‹ä¸‹è¯¥å¦‚ä½•è®¾ç½®ã€‚</p><p>é¦–å…ˆï¼Œæ‰“å¼€è°·æ­Œæµè§ˆå™¨ï¼Œæ‰¾åˆ°â€œè®¾ç½®â€å…¥å£ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-7.png" alt="github--lena"></p><p>ç„¶åï¼Œåœ¨è®¾ç½®ç•Œé¢å·¦ä¾§æ ï¼ŒæŸ¥çœ‹é«˜çº§åŠŸèƒ½ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-8.png" alt="github--lena"></p><p>åœ¨é«˜çº§åŠŸèƒ½ä¸­ï¼Œæ‰¾åˆ°â€œè¯­è¨€â€é€‰é¡¹ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-9.png" alt="github--lena"></p><p>ç‚¹å‡»ä¸‹æ‹‰æ ‡ç­¾ï¼ŒæŸ¥çœ‹è¯­è¨€è®¾ç½®ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-10.png" alt="github--lena"></p><p>ç‚¹å‡»â€œæ·»åŠ è¯­è¨€â€ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-11.png" alt="github--lena"></p><p>æ·»åŠ â€œè‹±è¯­-ç¾å›½â€ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-12.png" alt="github--lena"></p><p>æ‰“å¼€ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰è¯­è¨€é€‰é¡¹ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-13.png" alt="github--lena"></p><p>åˆ é™¤ä¸­æ–‡è¯­è¨€ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-14.png" alt="github--lena"></p><p>åªç•™ä¸‹è‹±æ–‡è¯­è¨€ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-15.png" alt="github--lena"></p><p>ä»¥ä¸Šè®¾ç½®å®Œæˆåï¼Œå…³é—­æµè§ˆå™¨ï¼Œç„¶åé‡æ–°æ‰“å¼€ï¼Œé‡æ–°ç”³è¯·è°·æ­Œè´¦å·ï¼Œä½ ä¼šå‘ç°ç”µè¯å·ç é—®é¢˜æ²¡æœ‰äº†ã€‚</p><h1><span id="ç¬¬5æ­¥é€šè¿‡éªŒè¯ç è¿›è¡Œè´¦å·éªŒè¯">ç¬¬5æ­¥ï¼šé€šè¿‡éªŒè¯ç è¿›è¡Œè´¦å·éªŒè¯</span></h1><p>æ‰‹æœºæ¥æ”¶åˆ°éªŒè¯ç åï¼ŒæŒ‰è¦æ±‚å¡«å…¥ï¼Œç„¶åç‚¹å‡»â€œéªŒè¯â€ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-16.png" alt="github--lena"></p><p>æˆåŠŸéªŒè¯åï¼Œå¡«å†™è´¦å·éœ€æ±‚çš„å…¶ä»–ä¿¡æ¯ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-17.png" alt="github--lena"></p><p>åœ¨å…¶ä»–GoogleæœåŠ¡ä¸­ä½¿ç”¨å·ç ï¼Œç›´æ¥è·³è¿‡ï¼š<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-18.png" alt="github--lena"></p><h1><span id="ç¬¬6æ­¥åŒæ„googleè´¦å·ç›¸å…³æ¡æ¬¾">ç¬¬6æ­¥ï¼šåŒæ„Googleè´¦å·ç›¸å…³æ¡æ¬¾</span></h1><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-19.png" alt="github--lena"></p><p>ç‚¹å‡»â€œæˆ‘åŒæ„â€<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-20.png" alt="github--lena"></p><h1><span id="ç¬¬7æ­¥æˆåŠŸæ³¨å†Œè°·æ­Œè´¦å·">ç¬¬7æ­¥ï¼šæˆåŠŸæ³¨å†Œè°·æ­Œè´¦å·</span></h1><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œè°·æ­Œè´¦å·å°±æ³¨å†Œå¥½äº†ï¼Œåœ¨è°·æ­Œæœç´¢ç•Œé¢å¯ä»¥çœ‹åˆ°è´¦å·å·²ç»å¤„äºç™»å½•çŠ¶æ€ã€‚<br><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/create-google-account-21.png" alt="github--lena"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;ç¬¬1æ­¥æ‰¾åˆ°è°·æ­Œè´¦å·æ³¨å†Œå…¥å£&quot;&gt;ç¬¬1æ­¥ï¼šæ‰¾åˆ°è°·æ­Œè´¦å·æ³¨å†Œå…¥å£&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;æ‰“å¼€Googleï¼Œåœ¨è°·æ­Œæœç´¢çš„ä¸»ç•Œé¢ï¼Œæ‰¾åˆ°å³ä¸Šè§’çš„ç™»å½•è´¦å·æŒ‰é’®ã€‚æˆ‘è¿™é‡Œæµè§ˆå™¨è¯­è¨€æ˜¯ä¸­æ–‡çš„ï¼Œæ‰€ä»¥æ˜¯æ˜¾ç¤ºä¸­æ–‡ï¼Œå¦‚æœæ˜¯é»˜è®¤è‹±æ–‡è¯­è¨€çš„æµè§ˆå™¨ï¼Œæ‰“å¼€å°±ä¼šæ˜¾ç¤ºè‹±æ–‡ï¼Œä½†æŒ‰é’®ä½ç½®æ˜¯</summary>
      
    
    
    
    <category term="å¥‡æ€ªçš„çŸ¥è¯†ç‚¹" scheme="https://imszz.com/categories/%E5%A5%87%E6%80%AA%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    
    
    <category term="google" scheme="https://imszz.com/tags/google/"/>
    
  </entry>
  
  <entry>
    <title>seleniumåŸºç¡€-æ‰“å¼€ç™¾åº¦è¿›è¡Œæœç´¢</title>
    <link href="https://imszz.com/p/1f7c743b/"/>
    <id>https://imszz.com/p/1f7c743b/</id>
    <published>2020-10-14T13:25:23.000Z</published>
    <updated>2020-10-15T05:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>å®‰è£…Python3</p></li><li><p>å®‰è£…selenium</p><div class="note warning"><p>æ³¨æ„ä¸åŒçš„pythonç‰ˆæœ¬</p></div></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install selenium</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¸‹è½½è°·æ­Œé©±åŠ¨ChromeDriveråŒ…ï¼Œæ”¾åˆ°Pythonçš„ç›®å½•ä¸‹</li></ol><div class="note success"><p><a href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a></p></div><div class="note warning"><p>mac å®‰è£…è·¯å¾„è§£å‹åˆ°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;bin</span><br></pre></td></tr></table></figure><p>windows è§£å‹åˆ°ä¸ python.exe åŒçº§</p></div><ol start="4"><li>ç¼–å†™ä»£ç ï¼Œå¦‚ä¸‹<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line"></span><br><span class="line">from selenium import webdriver  # æµè§ˆå™¨é©±åŠ¨å™¨</span><br><span class="line">from selenium.webdriver.common.by import By  # å®šä½å™¨</span><br><span class="line">from selenium.webdriver.common.keys import Keys  # é”®ç›˜å¯¹è±¡</span><br><span class="line">from selenium.webdriver.support import expected_conditions as EC  # åˆ¤æ–­å™¨</span><br><span class="line">from selenium.webdriver.support.wait import WebDriverWait  # æµè§ˆå™¨ç­‰å¾…å¯¹åƒ</span><br><span class="line">import time</span><br><span class="line"># åˆ›å»ºä¸€ä¸ªè°·æ­Œæµè§ˆå™¨å¯¹è±¡</span><br><span class="line">browser &#x3D; webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    # æµè§ˆå™¨å¯¹è±¡æ‰“å¼€ç™¾åº¦åœ°å€</span><br><span class="line">    browser.get(&quot;https:&#x2F;&#x2F;www.baidu.com&quot;)</span><br><span class="line">    # æŸ¥æ‰¾idä¸º &#39;kw&#39;çš„æ ‡ç­¾ï¼Œå³è¾“å…¥æ¡†</span><br><span class="line">    inputs &#x3D; browser.find_element_by_id(&quot;kw&quot;)</span><br><span class="line">    # åœ¨è¾“å…¥æ¡†ä¸­å¡«å…¥&#39;Python&#39;</span><br><span class="line">    inputs.send_keys(&quot;Python&quot;)</span><br><span class="line">    # &#39;æŒ‰ä¸‹&#39;å›è½¦é”®ï¼ˆç¬¬ä¸€ç§ï¼‰</span><br><span class="line">    inputs.send_keys(Keys.ENTER)</span><br><span class="line">    # ç‚¹å‡»&#39;ç™¾åº¦ä¸€ä¸‹&#39;ï¼ˆç¬¬äºŒç§ï¼‰</span><br><span class="line">    # browser.find_element_by_id(&quot;su&quot;).click()</span><br><span class="line">    # åˆ›å»ºä¸€ä¸ªç­‰å¾…å¯¹åƒï¼Œè¶…æ—¶æ—¶é—´ä¸º10ç§’ï¼Œè°ƒç”¨çš„æ—¶é—´é—´éš”ä¸º0.5</span><br><span class="line">    wait &#x3D; WebDriverWait(browser, 10, 0.5)</span><br><span class="line">    # æ¯éš”0.5ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œç›´åˆ°é¡µé¢å…ƒç´ å‡ºç°idä¸º&#39;content_left&#39;çš„æ ‡ç­¾</span><br><span class="line">    wait.until(EC.presence_of_all_elements_located((By.ID, &quot;content_left&quot;)))</span><br><span class="line">except Exception as e:</span><br><span class="line">    print (e)</span><br><span class="line">else:</span><br><span class="line">    # æ‰“å°è¯·æ±‚çš„url</span><br><span class="line">    print (browser.current_url)</span><br><span class="line">    # æ‰“å°æ‰€æœ‰cookies</span><br><span class="line">    print (browser.get_cookies())</span><br><span class="line">finally:</span><br><span class="line">    # ç­‰å¾…10ç§’</span><br><span class="line">    time.sleep(10)</span><br><span class="line">    # å…³é—­æµè§ˆå™¨å¯¹è±¡</span><br><span class="line">    browser.close()</span><br></pre></td></tr></table></figure><div class="note warning"><p>py2ä¸py3 print è¯­æ³•ä¸åŒ </p></div></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å®‰è£…Python3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®‰è£…selenium&lt;/p&gt;
&lt;div class=&quot;note warning&quot;&gt;&lt;p&gt;æ³¨æ„ä¸åŒçš„pythonç‰ˆæœ¬&lt;/p&gt;
&lt;/div&gt;

&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;high</summary>
      
    
    
    
    <category term="python" scheme="https://imszz.com/categories/python/"/>
    
    
    <category term="python" scheme="https://imszz.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>å¼€å¾€ä¸‹ä¸€ä¸ªä¸–ç•Œ â€” å‹é“¾æ¥åŠ›</title>
    <link href="https://imszz.com/p/ba1e0fab/"/>
    <id>https://imszz.com/p/ba1e0fab/</id>
    <published>2020-09-01T16:46:25.000Z</published>
    <updated>2020-09-06T13:26:23.000Z</updated>
    
    <content type="html"><![CDATA[<div class="note info"><p>äº’è”ç½‘å°†äººä¸äººä¹‹é—´çš„è·ç¦»å¤§å¤§å‡å°ï¼Œå´è¿˜æ˜¯å½¢æˆäº†å¤§å¤§å°å°çš„å­¤å²›ã€‚åªæœ‰ç†Ÿäººé—´æ‰çŸ¥é“å½¼æ­¤ï¼Œè€Œé™Œç”Ÿäººæ°¸è¿œåªèƒ½æ˜¯é™Œç”Ÿäººã€‚</p></div><h2><span id="ä»€ä¹ˆæ˜¯å¼€å¾€-å‹é“¾æ¥åŠ›">ä»€ä¹ˆæ˜¯å¼€å¾€ - å‹é“¾æ¥åŠ›</span></h2><p>äº’è”ç½‘ç»å†äº†ä¸€ä¸ªå°é—­åˆ°å¼€æ”¾ï¼Œç°åœ¨é€æ¸åˆèµ°å‘å°é—­çš„è¿‡ç¨‹ã€‚å¤§å¤§å°å°çš„å­¤å²›æ•£è½åœ¨æµ©ç€šçƒŸæµ·ï¼Œæ¥å¾€å°±åƒæ˜¯ä¸€é¢—é¢—æ˜Ÿçƒä¹‹é—´çš„å¿«é€Ÿåˆ—è½¦ï¼Œéšæœºçš„è·³å‘ä¸‹ä¸€ç«™ã€‚</p><div class="note success"><p>æˆ‘æƒ³åœ¨è¿™çƒŸæµ·å‘ç°ä¸‹ä¸€é¢—æ˜Ÿâ€¦</p></div><p>å¼€å¾€-å‹é“¾åŠ©åŠ›æ˜¯ä¼ ç»Ÿå‹é“¾çš„å¢å¼ºï¼Œæˆ‘ä»¬ä¸å¿…äº’ç›¸çŸ¥é“äº†è§£å½¼æ­¤ï¼Œæ ‡å‡†çš„å®¡æŸ¥è®©å‹å¥½çš„æœ‹å‹åŠ å…¥æˆ‘ä»¬ï¼Œåªéœ€è¦ä¸€ä¸ªå¾½æ ‡ï¼Œå ç”¨ä¸€å—ä½ç½®ï¼Œæˆ‘ä»¬æ‰€æœ‰äººéƒ½è”ç³»åœ¨äº†ä¸€èµ·ï¼Œç®€å•è€Œåˆå¼ºå¤§ã€‚</p><h2><span id="å’Œæˆ‘ä¸€èµ·åŠ å…¥å¼€å¾€">å’Œæˆ‘ä¸€èµ·åŠ å…¥å¼€å¾€</span></h2><p>ã€å¼€å¾€ã€å–è‡ªã€Œå¼€æ”¾çš„ç½‘ç»œã€ã€‚å°†å¼€å¾€çš„å¾½æ ‡æ’å…¥æ‚¨çš„ç½‘ç«™ï¼Œè¡¨ç¤ºæ‚¨æ”¯æŒå¼€æ”¾çš„ç½‘ç»œã€‚</p><p>æ¯å½“æœ‰ç”¨æˆ·è®¿é—®åŠ å…¥å¼€å¾€çš„ç½‘ç«™æ—¶ï¼Œç‚¹å‡»å¾½æ ‡åä¼šéšæœºè·³è½¬åˆ°å¦ä¸€ä¸ªåŠ å…¥å¼€å¾€çš„ç½‘ç«™ã€‚åŠ å…¥å¼€å¾€çš„ç½‘ç«™è¶Šå¤šï¼Œå‹é“¾æ¥åŠ›çš„è§„æ¨¡è¶Šå¤§ï¼Œåˆ†äº«çš„æµé‡ä¹Ÿè¶Šå¤šã€‚</p><p>â€œ ç½‘ç«™E â†’ å¼€å¾€ â†’ ç½‘ç«™X â†’ å¼€å¾€ â†’ ç½‘ç«™A â†’ å¼€å¾€ â†’ ç½‘ç«™M â†’ å¼€å¾€ â†’ ç½‘ç«™P â†’ å¼€å¾€ â†’ ç½‘ç«™L â†’ å¼€å¾€ â†’ ç½‘ç«™E â€¦ â€œ</p><p>Github åœ°å€ï¼š</p><div class="note success"><p><a href="https://github.com/volfclub/travellings">https://github.com/volfclub/travellings</a></p></div><p>è¿™æ˜¯é¡¹ç›®çš„ Github åœ°å€ï¼Œåœ¨ issue ä¸­æäº¤ç”³è¯·ï¼Œå‡ æ—¥å†…å°±ä¼šå—ç†ã€‚ä½†æ˜¯ç”³è¯·çš„ç½‘ç«™å¿…é¡»æ»¡è¶³å‡ ç‚¹è¦æ±‚ï¼š</p><ol><li>æ„¿ä¸ºå¼€æ”¾çš„ç½‘ç»œåšå‡ºè´¡çŒ®ï¼ˆå¦‚åˆ†äº«çŸ¥è¯†ç»éªŒè®¾è®¡ç­‰ï¼‰ï¼›</li><li>æ²¡æœ‰è¿æ³•ä»¥åŠå½±å“ä½“éªŒçš„å†…å®¹ï¼ˆå¦‚ä¾µå…¥å¼å¹¿å‘Šç­‰ï¼‰ï¼›</li><li>æ­£å¸¸æ›´æ–°ç»´æŠ¤ä¸­ï¼ˆå›½å†…æ— æ³•æ­£å¸¸è®¿é—®ä¼šè¢«ç§»é™¤ï¼‰ï¼›</li><li>å¼ºåˆ¶å¯ç”¨ https ã€‚</li></ol><p>å°†å¾½æ ‡æ’å…¥æ‰“å¼€æ‚¨ç½‘é¡µåèƒ½ç›´æ¥çœ‹åˆ°çš„åœ°æ–¹ï¼ˆè®©å‹é“¾ä¼ é€’ä¸‹å»ï¼‰ï¼Œæå‡º issues ç”³è¯·æ”¶å½•ã€‚è¿™ä¸€èˆ¬åœ¨ 7 ä¸ªå·¥ä½œæ—¥å†…å®Œæˆå®¡æ ¸ã€‚å¯¹äºåšå®¢ç­‰ä¸æ–¹ä¾¿æ’å…¥å¾½æ ‡çš„ç½‘é¡µï¼Œå»ºè®®åœ¨é¡¶éƒ¨æˆ–ä¾§æ å¯¼èˆªæ’å…¥ Travelling æˆ–å¼€å¾€çš„å¤–é“¾ï¼Œåœ¨ç½‘é¡µåº•éƒ¨æ’å…¥å¾½æ ‡ã€‚</p><p>å‚å¼€ä»£ç å¦‚ä¸‹ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ logo:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;travellings.now.sh&#x2F;&quot; target&#x3D;&quot;blank&quot; title&#x3D;&quot;å¼€å¾€-å‹é“¾æ¥åŠ›&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;travellings.now.sh&#x2F;assets&#x2F;logo.gif&quot; alt&#x3D;&quot;å¼€å¾€-å‹é“¾æ¥åŠ›&quot; width&#x3D;&quot;120&quot;&gt;&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure><p>æ„¿æˆ‘ä»¬ä¸å†å­¤ç‹¬ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note info&quot;&gt;&lt;p&gt;äº’è”ç½‘å°†äººä¸äººä¹‹é—´çš„è·ç¦»å¤§å¤§å‡å°ï¼Œå´è¿˜æ˜¯å½¢æˆäº†å¤§å¤§å°å°çš„å­¤å²›ã€‚åªæœ‰ç†Ÿäººé—´æ‰çŸ¥é“å½¼æ­¤ï¼Œè€Œé™Œç”Ÿäººæ°¸è¿œåªèƒ½æ˜¯é™Œç”Ÿäººã€‚&lt;/p&gt;
&lt;/div&gt;

&lt;h2&gt;&lt;span id=&quot;ä»€ä¹ˆæ˜¯å¼€å¾€-å‹é“¾æ¥åŠ›&quot;&gt;ä»€ä¹ˆæ˜¯å¼€å¾€ - å‹é“¾æ¥åŠ›&lt;/span&gt;&lt;</summary>
      
    
    
    
    <category term="link" scheme="https://imszz.com/categories/link/"/>
    
    
    <category term="link" scheme="https://imszz.com/tags/link/"/>
    
  </entry>
  
  <entry>
    <title>Hexo å‡çº§æ•™ç¨‹</title>
    <link href="https://imszz.com/p/cb1e6c4f/"/>
    <id>https://imszz.com/p/cb1e6c4f/</id>
    <published>2020-09-01T13:25:23.000Z</published>
    <updated>2020-10-29T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h5><span id="ç®€-è¿°-å°†ç”µè„‘çš„-hexo-v421-å‡çº§åˆ°-hexo-v511">ç®€ è¿°ï¼š å°†ç”µè„‘çš„ <code>hexo v4.2.1</code> å‡çº§åˆ° <code>hexo v5.1.1</code> ã€‚</span></h5><h3><span id="èƒŒæ™¯">èƒŒæ™¯ï¼š</span></h3><p><code>hexo clean &amp;&amp; hexo g -s</code> åï¼Œå‘ç°ä¼šå¼ºåˆ¶å°†æ‰€æœ‰æ–‡ç« çš„æ–‡ä»¶çš„ä¿®æ”¹æ—¥æœŸï¼Œåœ¨æ–‡ç« ä¸­æ˜¾ç¤ºï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä¿®æ”¹ hexo å·¥ä½œç›®å½•ä¸‹ <code>_config.yml</code> ä¸­ä¿®æ”¹ä¸º <code>updated_option: &quot;date&quot;</code> ï¼Œä½†æ˜¯è¿™ä¸ªå˜é‡æ˜¯åªæœ‰ hexo v5.0 æ‰æ”¯æŒï¼Œè€Œæˆ‘å½“å‰æ˜¯ v4.2ã€‚</p><h5><span id="æœªå‡çº§ä¹‹å‰å½“å‰é…ç½®">æœªå‡çº§ä¹‹å‰ï¼Œå½“å‰é…ç½®:</span></h5><ul><li>hexo: 4.2.1</li><li>node: 12.18.3</li></ul><h3><span id="å‡çº§-hexo">å‡çº§ Hexo:</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨æ·˜å®æºçš„ cnpm æ›¿æ¢ npm</span><br><span class="line">npm install -g cnpm --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">cnpm install -g cnpm                 # å‡çº§ npm</span><br><span class="line">cnpm cache clean -f                 # æ¸…é™¤ npm ç¼“å­˜</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&#x3D;æ›´æ–° hexo: è¿›å…¥ blog ç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤&#x3D;&#x3D;&#x3D; </span><br><span class="line"># æ›´æ–° package.json ä¸­çš„ hexo åŠä¸ªæ’ä»¶ç‰ˆæœ¬</span><br><span class="line">cnpm install -g npm-check           # æ£€æŸ¥ä¹‹å‰å®‰è£…çš„æ’ä»¶ï¼Œéƒ½æœ‰å“ªäº›æ˜¯å¯ä»¥å‡çº§çš„ </span><br><span class="line">cnpm install -g npm-upgrade         # å‡çº§ç³»ç»Ÿä¸­çš„æ’ä»¶</span><br><span class="line">npm-check</span><br><span class="line">npm-upgrade</span><br><span class="line"></span><br><span class="line"># æ›´æ–° hexo åŠæ‰€æœ‰æ’ä»¶</span><br><span class="line">cnpm update</span><br><span class="line"></span><br><span class="line"># ç¡®è®¤ hexo å·²ç»æ›´æ–°</span><br><span class="line">hexo -v</span><br></pre></td></tr></table></figure><h5><span id="å‡çº§ä¹‹åçš„ç‰ˆæœ¬">å‡çº§ä¹‹åçš„ç‰ˆæœ¬ï¼š</span></h5><ul><li>Hexo: 5.1.1</li><li>Node: 12.18.3</li></ul><p>å†æ¬¡æ­£å¸¸æ¨é€ï¼ŒæˆåŠŸè¾¾åˆ°é¢„æœŸã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h5&gt;&lt;span id=&quot;ç®€-è¿°-å°†ç”µè„‘çš„-hexo-v421-å‡çº§åˆ°-hexo-v511&quot;&gt;ç®€ è¿°ï¼š å°†ç”µè„‘çš„ &lt;code&gt;hexo v4.2.1&lt;/code&gt; å‡çº§åˆ° &lt;code&gt;hexo v5.1.1&lt;/code&gt; ã€‚&lt;/span&gt;&lt;/h5&gt;&lt;h3&gt;&lt;span id=&quot;èƒŒ</summary>
      
    
    
    
    <category term="hexo" scheme="https://imszz.com/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://imszz.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>ä¿®æ”¹è„šåº•è‡ªå®šä¹‰æ ‡ç­¾</title>
    <link href="https://imszz.com/p/8cad5570/"/>
    <id>https://imszz.com/p/8cad5570/</id>
    <published>2020-08-31T12:46:25.000Z</published>
    <updated>2020-09-01T13:26:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="åˆ›å»ºæ ·å¼">åˆ›å»ºæ ·å¼</span></h2><p>æ‰¾åˆ°<code>themes/butterfly/source/css/_global/function.styl</code>æ–‡ä»¶,ä»»æ„ä½ç½®æ·»åŠ ä»£ç </p><p>æ ·å¼ä»£ç å¯ä»¥è‡ªå®šä¹‰æ·»åŠ <br>ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*åº•éƒ¨ä¿¡æ¯*&#x2F;</span><br><span class="line"></span><br><span class="line">.github-badge &#123;</span><br><span class="line">    margin-left: 5px;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    text-shadow: none;</span><br><span class="line">    color: #fff;</span><br><span class="line">    line-height: 15px;</span><br><span class="line">    background-color: #abbac3;</span><br><span class="line">    margin-bottom: 5px;</span><br><span class="line">    font-size: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .badge-subject &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    background-color: #4d4d4d;</span><br><span class="line">    padding: 4px 4px 4px 6px;</span><br><span class="line">    border-top-left-radius: 4px;</span><br><span class="line">    border-bottom-left-radius: 4px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .badge-value &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    padding: 4px 6px 4px 4px;</span><br><span class="line">    border-top-right-radius: 4px;</span><br><span class="line">    border-bottom-right-radius: 4px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .bg-blue &#123;</span><br><span class="line">    background-color: #007ec6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .bg-brightgreen &#123;</span><br><span class="line">    background-color: #4dc820;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .bg-orange &#123;</span><br><span class="line">    background-color: orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .bg-gradient &#123;</span><br><span class="line">    background: linear-gradient(to right,#3ca5f6,#a86af9);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.github-badge .bg-blueviolet &#123;</span><br><span class="line">    background-color: #8833d7;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="å¼•ç”¨">å¼•ç”¨</span></h2><p>æ‰¾åˆ°<code>themes/butterfly/layout/includes/footer.pug</code>æ–‡ä»¶,æ·»åŠ ä¸‹é¢ä»£ç å³å¯</p><p>å¼•ç”¨æ ·å¼ï¼Œå¯ä»¥æŒ‰ç…§æ ¼å¼è‡ªå®šä¹‰åˆ å‡åŠ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;https:&#x2F;&#x2F;hexo.io&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;ç”± Hexo å¼ºåŠ›é©±åŠ¨&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject Powered</span><br><span class="line">      span.badge-value.bg-blue Hexo</span><br><span class="line">  </span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;https:&#x2F;&#x2F;coding.net&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;é™æ€ç½‘é¡µæ‰˜ç®¡äº GitHub Pages å’Œ Coding Pages&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject Hosted</span><br><span class="line">      span.badge-value.bg-brightgreen Coding</span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;https:&#x2F;&#x2F;github.com&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;é™æ€ç½‘é¡µæ‰˜ç®¡äº GitHub Pages å’Œ Coding Pages&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject Hosted</span><br><span class="line">      span.badge-value.bg-brightgreen GitHub </span><br><span class="line"></span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;https:&#x2F;&#x2F;www.jsdelivr.com&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;jsDelivr æä¾› CDN åŠ é€ŸæœåŠ¡&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject CDN</span><br><span class="line">      span.badge-value.bg-orange jsDelivr</span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;http:&#x2F;&#x2F;creativecommons.org&#x2F;licenses&#x2F;by-nc-sa&#x2F;4.0&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;æœ¬ç«™ç‚¹é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject</span><br><span class="line">        i.fa.fa-copyright</span><br><span class="line">      span.badge-value.bg-gradient BY-NC-SA 4.0</span><br><span class="line"></span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;https:&#x2F;&#x2F;github.com&#x2F;jerryc127&#x2F;hexo-theme-butterfly&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;ä¸»é¢˜&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject Theme</span><br><span class="line">      span.badge-value.bg-blueviolet Butterfly </span><br><span class="line">  </span><br><span class="line">  .github-badge</span><br><span class="line">    a(style&#x3D;&#39;color:#fff&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;http:&#x2F;&#x2F;www.beian.miit.gov.cn&#x2F;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;å¤‡æ¡ˆ&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">      span.badge-subject æµ™ICPå¤‡</span><br><span class="line">      span.badge-value.bg-orange 20027461å·</span><br><span class="line">  .github-badge</span><br><span class="line">    span.badge-subject æœ¬ç«™å·²å®‰å…¨è¿è¡Œ</span><br><span class="line">    a(style&#x3D;&#39;text-decoration:none;color:#fff;background:#007ec6;padding: 4px 4px 4px 6px;border-top-right-radius: 4px;border-bottom-right-radius: 4px;width:168px;display: inline-block;&#39;,id&#x3D;&#39;running-time&#39;, rel&#x3D;&#39;external nofollow noopener noreferrer&#39;, href&#x3D;&#39;&#39;, target&#x3D;&#39;_blank&#39;, title&#x3D;&#39;ç½‘ç«™è¿è¡Œæ—¶é—´&#39;, data-pjax-state&#x3D;&#39;&#39;)</span><br><span class="line">  #running-time</span><br><span class="line">    script.</span><br><span class="line">      setInterval(()&#x3D;&gt;&#123;let create_time&#x3D;Math.round(new Date(&#39;2020-07-20 00:00:00&#39;).getTime()&#x2F;1000);let timestamp&#x3D;Math.round((new Date().getTime()+8*60*60*1000)&#x2F;1000);let second&#x3D;timestamp-create_time;let time&#x3D;new Array(0,0,0,0,0);if(second&gt;&#x3D;365*24*3600)&#123;time[0]&#x3D;parseInt(second&#x2F;(365*24*3600));second%&#x3D;365*24*3600;&#125;if(second&gt;&#x3D;24*3600)&#123;time[1]&#x3D;parseInt(second&#x2F;(24*3600));second%&#x3D;24*3600;&#125;if(second&gt;&#x3D;3600)&#123;time[2]&#x3D;parseInt(second&#x2F;3600);second%&#x3D;3600;&#125;if(second&gt;&#x3D;60)&#123;time[3]&#x3D;parseInt(second&#x2F;60);second%&#x3D;60;&#125;if(second&gt;0)&#123;time[4]&#x3D;second;&#125;currentTimeHtml&#x3D;time[0]+&#39; å¹´ &#39;+time[1]+&#39;  å¤©  &#39;+time[2]+&#39;  æ—¶  &#39;+time[3]+&#39;  åˆ†  &#39;+time[4]+&#39;  ç§’&#39;;document.getElementById(&quot;running-time&quot;).innerHTML&#x3D;currentTimeHtml;&#125;,1000);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;åˆ›å»ºæ ·å¼&quot;&gt;åˆ›å»ºæ ·å¼&lt;/span&gt;&lt;/h2&gt;

&lt;p&gt;æ‰¾åˆ°&lt;code&gt;themes/butterfly/source/css/_global/function.styl&lt;/code&gt;æ–‡ä»¶,ä»»æ„ä½ç½®æ·»åŠ ä»£ç &lt;/p&gt;
&lt;p&gt;æ ·å¼ä»£ç å¯ä»¥è‡ªå®šä¹‰æ·»åŠ &lt;br&gt;ç¤º</summary>
      
    
    
    
    <category term="hexo" scheme="https://imszz.com/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://imszz.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes è°ƒåº¦å’Œé©±é€</title>
    <link href="https://imszz.com/p/761d0096/"/>
    <id>https://imszz.com/p/761d0096/</id>
    <published>2020-08-25T12:46:25.000Z</published>
    <updated>2020-09-07T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="æ¦‚å¿µ"> æ¦‚å¿µ</span></h2><p><a href="https://kubernetes.io/zh/docs/concepts/scheduling-eviction/assign-pod-node/">Kubernetes è°ƒåº¦å’Œé©±é€ doc</a></p><ul><li>nodeä¸Šæ‰€æœ‰ç»„ä»¶ï¼ˆkubelet/kube-proxyï¼‰éƒ½æ˜¯ä¸apiserveré€šä¿¡</li><li>masterä¸Šä¸¤ä¸ªç»„ä»¶ï¼ˆscheduler/controller-managerï¼‰éƒ½æ˜¯ä¸apiserveré€šä¿¡</li><li>apiserverå°†å…¶ä»–ç»„ä»¶é€šä¿¡äº§ç”Ÿçš„äº‹ä»¶ã€çŠ¶æ€éƒ½ä¿å­˜åˆ°äº†ä¸etcdæ•°æ®åº“ä¸­</li><li>å…¶ä»–ç»„ä»¶ä¸apiserverå‘¨æœŸæ€§watchäº‹ä»¶ã€‚</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/image-94cf1a9a.png" alt="github--lena"></p><p>å›¾ç‰‡è§£é‡Šï¼š</p><p><code>kubectl</code>é€šè¿‡è¯»å–é›†ç¾¤é…ç½®æ–‡ä»¶ <code>~/.kube/config</code> å°†è¯·æ±‚å‘ç»™<code>apiserver</code>ï¼Œä¹‹å<code>apiserver</code>å°†åˆ›å»ºpodçš„å±æ€§ä¿¡æ¯å†™å…¥åˆ°<code>etcd</code>ä¸­ï¼Œ<code>etcd</code>ä¼šå“åº”ä¸€ä¸ªçŠ¶æ€ç»™<code>apiserver</code>ï¼Œä¿å­˜<code>etcd</code>æˆåŠŸä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤º<code>pod/&lt;podåç§°&gt; created</code>ï¼Œä¹‹åè°ƒåº¦ç»„ä»¶<code>scheduler</code>ä¸Šçº¿ï¼Œè´Ÿè´£å°†æ–°çš„<code>pod</code>åˆ†é…åˆ°åˆé€‚çš„èŠ‚ç‚¹ä¸Šï¼Œè°ƒåº¦ä¹‹åï¼Œå°†ç»“æœå“åº”ç»™<code>apiserver</code>ï¼Œ<code>apiserver</code>å†å°†ç»“æœä¿å­˜åˆ°<code>etcd</code>ä¸­ï¼Œ<code>kubelet</code>å½“å‘ç°æœ‰ä¸ª<code>pod</code>è¢«ç»‘å®šåˆ°è‡ªå·±çš„èŠ‚ç‚¹ä¸Šæ—¶ï¼Œå°±ä¼šè°ƒç”¨<code>docker</code>çš„<code>api</code>å»åˆ›å»ºå®¹å™¨ï¼Œå®¹å™¨åˆ›å»ºä¹‹åï¼Œ<code>docekr</code>ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ç»™<code>kubelet</code>ï¼Œåˆ›å»ºæˆåŠŸä¹‹åï¼Œ<code>kubelet</code>å†é€šçŸ¥<code>apiserver</code>å®¹å™¨çŠ¶æ€ï¼Œä¹‹å<code>apiserver</code>å†å°†çŠ¶æ€å†™å…¥åˆ°<code>etcd</code>ä¸­ï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨<code>kubelet get pod</code>å»æŸ¥çœ‹<code>pod</code>çš„çŠ¶æ€äº†</p><blockquote><p>æ³¨æ„ï¼šæœ‰äººä¼šæ³¨æ„åˆ°ï¼Œä¸Šå›¾ä¸­å°‘äº†ä¸¤ä¸ªç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯nodeä¸Šçš„kube-proxyå’Œmasterä¸Šçš„controller-manager,å…¶ä¸­kube-proxyä¸»è¦è´Ÿè´£podçš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ï¼Œåœ¨å›¾ç‰‡ä¸­çš„ä½ç½®å°±æ˜¯ä»‹äºkubeletä¸Dockerä¹‹é—´,å®ƒçš„å¾ˆå¤šå·¥ä½œä¸kubeletæ˜¯å¹¶è¡Œå®Œæˆçš„ï¼Œä¸»è¦è´Ÿè´£æä¾›podå¯¹å¤–è®¿é—®çš„ä¸€ç§å½¢å¼ã€‚controller-managerç»„ä»¶ä¸»è¦æ˜¯å®Œæˆåå°çš„ä¸€äº›ä»»åŠ¡ï¼Œä¾‹å¦‚deploymentä¸daemonsetæ§åˆ¶å™¨ç­‰ï¼Œè€Œå›¾ç‰‡ä¸­æ˜¯ä¸æ¶‰åŠåˆ°åˆ›å»ºæ§åˆ¶å™¨çš„æ­¥éª¤çš„ï¼Œæ•…ä¸controller-managerå°±æ²¡ä»€ä¹ˆå…³ç³»ï¼Œå¦‚æœè¦åˆ›å»ºæ§åˆ¶å™¨çš„è¯ï¼Œè§’è‰²ä½ç½®ä»‹äºSchedulerä¸kubeletä¹‹é—´ï¼Œå®ƒè´Ÿè´£åˆ›å»ºå¤šå°‘ä¸ªå‰¯æœ¬ï¼Œå¯åŠ¨å¤šå°‘ä¸ªå‰¯æœ¬ï¼Œæ»šåŠ¨æ›´æ–°ç­‰æ›´é«˜çº§çš„åŠŸèƒ½ã€‚</p></blockquote><blockquote><p>æ€»ç»“ï¼š</p></blockquote><blockquote><p><code>kubectl</code> <code>( .kube/config)</code> -&gt; <code>apiserver</code> -&gt; <code>write etcd</code> -&gt; <code>scheduler</code> -&gt; è°ƒåº¦ç»“æœå“åº”ç»™<code>apiserver</code> -&gt; <code>kubelet</code> å‘ç°æœ‰åˆ†é…åˆ°æˆ‘çš„èŠ‚ç‚¹<code>pod</code> -&gt; è°ƒç”¨<code>docker api</code>åˆ›å»ºå®¹å™¨ -&gt; é€šçŸ¥<code>apiserver</code> å®¹å™¨çŠ¶æ€</p></blockquote><h2><span id="å½±å“podè°ƒåº¦çš„å› ç´ "> å½±å“Podè°ƒåº¦çš„å› ç´ </span></h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/image-d5fa9f73.png" alt="github--lena"></p><p>å‚æ•°è§£é‡Šï¼š</p><ul><li>resourcesï¼špodå ç”¨çš„ç¡¬ä»¶èµ„æºï¼ˆèµ„æºè°ƒåº¦ä¾æ®ï¼‰</li><li>schedulerNameï¼šé»˜è®¤è°ƒåº¦å™¨</li><li>nodeNameï¼šScheduleræ§åˆ¶å™¨è°ƒåº¦ç»‘å®šçš„èŠ‚ç‚¹</li><li>nodeSelectorï¼šæ ‡ç­¾é€‰æ‹©å™¨</li><li>affinityï¼šèŠ‚ç‚¹äº²å’Œæ€§</li><li>tolerationsï¼šæ±¡ç‚¹å®¹å¿</li></ul><blockquote><p>æ³¨æ„ï¼šè°ƒåº¦å™¨ï¼ˆschedulerNameï¼‰é™¤äº†ä½¿ç”¨è‡ªå·±çš„ä¸€äº›é»˜è®¤è¡Œä¸ºå’Œé»˜è®¤ç­–ç•¥ä¹‹å¤–ï¼Œä¹Ÿä¼šå‚è€ƒå…¶ä»–è°ƒåº¦ç­–ç•¥çš„å€¼ï¼ˆä¸»è¦å‚è€ƒï¼‰ã€‚</p></blockquote><h2><span id="resourcesèµ„æºé™åˆ¶"> resourcesï¼šèµ„æºé™åˆ¶</span></h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/iimage-9167643a.png" alt="github--lena"></p><p>Podå’ŒContainerçš„èµ„æºè¯·æ±‚å’Œé™åˆ¶ï¼š</p><ul><li><p>spec.containers[ ].resources.limits.cpu</p></li><li><p>spec.containers[ ].resources.limits.memory</p></li><li><p>spec.containers[ ].resources.requests.cpu</p></li><li><p>spec.containers[ ].resources.requests.memory</p></li><li><p>å‚æ•°è§£é‡Šï¼š</p></li><li><p>requestsï¼šèµ„æºè¯·æ±‚å€¼ï¼Œéƒ¨ç½²èµ„æºçš„æœ€å°é…åˆï¼Œæ˜¯è°ƒåº¦ä¾æ®ï¼Œä¼šæ ¹æ®requestsçš„å€¼å»åˆ¤å®šå½“å‰é›†ç¾¤ä¸­æœ‰æ— èŠ‚ç‚¹å»æ»¡è¶³è¯·æ±‚çš„é‡</p></li><li><p>limitsï¼šèµ„æºæœ€å¤§ä½¿ç”¨</p></li></ul><blockquote><p>requestså¿…é¡»å°äºlimitsçš„å€¼ï¼</p></blockquote><p>æ‰©å±•ï¼šæŸ¥çœ‹å½“å‰èŠ‚ç‚¹çš„èµ„æºä¿¡æ¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node &lt;node-name&gt;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/image-8b44afcd.png" alt="github--lena"></p><blockquote><p>æ³¨æ„ï¼š è‹¥podæ²¡æœ‰é…ç½®resourceså€¼ï¼Œåˆ™podå¯ä»¥ä½¿ç”¨å®¿ä¸»æœºæ‰€æœ‰èµ„æºï¼Œå¹¶ä¸”è°ƒåº¦ä¸å‚è€ƒé…é¢</p></blockquote><p>å»ºè®®ï¼š<code>requests</code>ä¸<code>limits</code>ä¸è¦ç›¸å·®å¤ªå¤š</p><h2><span id="nodeselector-nodeaffinity-èŠ‚ç‚¹æ ‡ç­¾å’ŒèŠ‚ç‚¹äº²å’Œ"> nodeSelector & nodeAffinity ï¼ˆèŠ‚ç‚¹æ ‡ç­¾å’ŒèŠ‚ç‚¹äº²å’Œï¼‰</span></h2><h3><span id="nodeselector"> nodeSelector</span></h3><p><code>nodeSelector</code>ï¼šç”¨äºå°†Podè°ƒåº¦åˆ°åŒ¹é…<code>Label</code> çš„Nodeä¸Š</p><p>ç»™èŠ‚ç‚¹æ‰“æ ‡ç­¾å¹¶æŸ¥çœ‹å¯¹åº”èŠ‚ç‚¹çš„æ ‡ç­¾ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl label nodes &lt;node-name&gt; key&#x3D;value</span><br><span class="line">kubectl get nodes &lt;node-name&gt; --show-labels</span><br></pre></td></tr></table></figure><blockquote><p>åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå¤šèŠ‚ç‚¹ï¼Œä¸”ä¸åŒèŠ‚ç‚¹é…ç½®ä¸ä¸€ï¼ŒåŠŸèƒ½ä¸ä¸€çš„æƒ…å†µã€‚</p></blockquote><p>yamlç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: pod-example</span><br><span class="line">spec:</span><br><span class="line">  nodeSelector:</span><br><span class="line">    disktype: ssd</span><br><span class="line">  containers:</span><br><span class="line">  - name: nginx</span><br><span class="line">    image: nginx:1.15</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè‹¥æ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•æ ‡ç­¾ï¼Œåˆ™podä¼šæ˜¾ç¤ºpendingçŠ¶æ€ï¼ŒèŠ‚ç‚¹éƒ½ä¸å¯ç”¨</p></blockquote><h3><span id="nodeaffinity"> nodeAffinity</span></h3><p><code>nodeAffinity</code>ï¼šèŠ‚ç‚¹äº²å’Œæ€§ï¼Œç±»ä¼¼äº<code>nodeSelector</code>ï¼Œå¯ä»¥æ ¹æ®èŠ‚ç‚¹ä¸Šçš„æ ‡ç­¾æ¥çº¦æŸPodå¯ä»¥è°ƒåº¦åˆ°å“ªäº›èŠ‚ç‚¹ã€‚</p><p>ç›¸æ¯”<code>nodeSelector</code>ï¼š</p><ul><li>åŒ¹é…æœ‰æ›´å¤šçš„é€»è¾‘ç»„åˆï¼Œä¸åªæ˜¯å­—ç¬¦ä¸²çš„å®Œå…¨ç›¸ç­‰(nodeSelectoræ˜¯ç»å¯¹ç›¸ç­‰çš„åŒ¹é…)</li><li>è°ƒåº¦åˆ†ä¸ºè½¯ç­–ç•¥å’Œç¡¬ç­–ç•¥ï¼Œè€Œä¸æ˜¯ç¡¬æ€§è¦æ±‚<br>a.ç¡¬ï¼ˆrequiredï¼‰ï¼šå¿…é¡»æ»¡è¶³<br>b.è½¯ï¼ˆpreferredï¼‰ï¼šå°è¯•æ»¡è¶³ï¼Œä½†ä¸ä¿è¯</li></ul><p>æ“ä½œç¬¦ï¼š<code>In</code>ã€<code>NotIn</code>ã€<code>Exists</code>ã€<code>oesNotExist</code>ã€<code>Gt</code>ã€<code>Lt</code></p><p>yamlç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: with-node-affinity</span><br><span class="line">spec:</span><br><span class="line">  affinity:</span><br><span class="line">    nodeAffinity:</span><br><span class="line">      requiredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">        nodeSelectorTerms:</span><br><span class="line">        - matchExpressions:</span><br><span class="line">          - key: kubernetes.io&#x2F;e2e-az-name</span><br><span class="line">            operator: In</span><br><span class="line">            values:</span><br><span class="line">            - e2e-az1</span><br><span class="line">            - e2e-az2</span><br><span class="line">      preferredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">      - weight: 1</span><br><span class="line">        preference:</span><br><span class="line">          matchExpressions:</span><br><span class="line">          - key: another-node-label-key</span><br><span class="line">            operator: In</span><br><span class="line">            values:</span><br><span class="line">            - another-node-label-value</span><br><span class="line">  containers:</span><br><span class="line">  - name: with-node-affinity</span><br><span class="line">    image: k8s.gcr.io&#x2F;pause:2.0</span><br></pre></td></tr></table></figure><p>å‚æ•°è§£é‡Šï¼š</p><ul><li>requiredDuringSchedulingIgnoredDuringExecutionï¼šç¡¬ç­–ç•¥ï¼ŒèŠ‚ç‚¹å¿…é¡»æ»¡è¶³çš„æ¡ä»¶</li><li>operatorï¼šæ“ä½œç¬¦</li><li>preferredDuringSchedulingIgnoredDuringExecutionï¼šè½¯ç­–ç•¥ï¼Œå°è¯•æ»¡è¶³ï¼Œä¸æ˜¯å¿…é¡»æ»¡è¶³çš„æ¡ä»¶</li><li>weightï¼šæƒé‡å€¼ï¼ŒèŒƒå›´1-100ï¼Œå€¼è¶Šå¤§ï¼Œæƒé‡è¶Šå¤§ï¼Œpodè°ƒåº¦åˆ°å¯¹åº”æ ‡ç­¾çš„èŠ‚ç‚¹æ¦‚ç‡è¶Šé«˜</li></ul><blockquote><p>æ³¨æ„ï¼šè‹¥ç¡¬é™åˆ¶ï¼ˆrequiredDuringSchedulingIgnoredDuringExecutionï¼‰æ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•æ ‡ç­¾ï¼Œåˆ™podä¼šæ˜¾ç¤ºpendingçŠ¶æ€ï¼ŒèŠ‚ç‚¹éƒ½ä¸å¯ç”¨ï¼Œå½“æ‰“å®Œæ ‡ç­¾ä¹‹åï¼Œpendingä¼šå˜ä¸ºrunningçŠ¶æ€</p></blockquote><blockquote><p>è¡¥å……ï¼š<br>èŠ‚ç‚¹äº²å’Œæ€§ï¼šå¸Œæœ›è°ƒåº¦åˆ°æŒ‡å®šæ ‡ç­¾çš„èŠ‚ç‚¹ä¸Šï¼›<br>åäº²å’Œæ€§ï¼šä¸å¸Œæœ›è°ƒåº¦åˆ°æŒ‡å®šæ ‡ç­¾çš„èŠ‚ç‚¹ä¸Šï¼Œå¦‚ä½¿ç”¨NotIn ï¼ŒDoesNotExistç­‰</p></blockquote><h3><span id="podaffinity-podantiaffinity-pod-é—´äº²å’Œä¸åäº²å’Œ"> podAffinity && podAntiAffinity ï¼ˆpod é—´äº²å’Œä¸åäº²å’Œï¼‰</span></h3><p>pod é—´äº²å’Œä¸åäº²å’Œä½¿ä½ å¯ä»¥åŸºäºå·²ç»åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ pod çš„æ ‡ç­¾æ¥çº¦æŸ pod å¯ä»¥è°ƒåº¦åˆ°çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åŸºäºèŠ‚ç‚¹ä¸Šçš„æ ‡ç­¾ã€‚è§„åˆ™çš„æ ¼å¼ä¸ºâ€œå¦‚æœ X èŠ‚ç‚¹ä¸Šå·²ç»è¿è¡Œäº†ä¸€ä¸ªæˆ–å¤šä¸ª æ»¡è¶³è§„åˆ™ Y çš„podï¼Œåˆ™è¿™ä¸ª pod åº”è¯¥ï¼ˆæˆ–è€…åœ¨éäº²å’Œçš„æƒ…å†µä¸‹ä¸åº”è¯¥ï¼‰è¿è¡Œåœ¨ X èŠ‚ç‚¹â€ã€‚Y è¡¨ç¤ºä¸€ä¸ªå…·æœ‰å¯é€‰çš„å…³è”å‘½ä»¤ç©ºé—´åˆ—è¡¨çš„ LabelSelectorï¼›ä¸èŠ‚ç‚¹ä¸åŒï¼Œå› ä¸º pod æ˜¯å‘½åç©ºé—´é™å®šçš„ï¼ˆå› æ­¤ pod ä¸Šçš„æ ‡ç­¾ä¹Ÿæ˜¯å‘½åç©ºé—´é™å®šçš„ï¼‰ï¼Œå› æ­¤ä½œç”¨äº pod æ ‡ç­¾çš„æ ‡ç­¾é€‰æ‹©å™¨å¿…é¡»æŒ‡å®šé€‰æ‹©å™¨åº”ç”¨åœ¨å“ªä¸ªå‘½åç©ºé—´ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼ŒX æ˜¯ä¸€ä¸ªæ‹“æ‰‘åŸŸï¼Œå¦‚èŠ‚ç‚¹ï¼Œæœºæ¶ï¼Œäº‘ä¾›åº”å•†åœ°åŒºï¼Œäº‘ä¾›åº”å•†åŒºåŸŸç­‰ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>topologyKey</code> æ¥è¡¨ç¤ºå®ƒï¼Œ</p><blockquote><p>è¯´æ˜ï¼š<br>Pod é—´äº²å’Œä¸åäº²å’Œéœ€è¦å¤§é‡çš„å¤„ç†ï¼Œè¿™å¯èƒ½ä¼šæ˜¾è‘—å‡æ…¢å¤§è§„æ¨¡é›†ç¾¤ä¸­çš„è°ƒåº¦ã€‚æˆ‘ä»¬ä¸å»ºè®®åœ¨è¶…è¿‡æ•°ç™¾ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ä¸­ä½¿ç”¨å®ƒä»¬</p></blockquote><p><code>topologyKey</code> æ˜¯èŠ‚ç‚¹æ ‡ç­¾çš„é”®ä»¥ä¾¿ç³»ç»Ÿç”¨æ¥è¡¨ç¤ºè¿™æ ·çš„æ‹“æ‰‘åŸŸã€‚</p><ul><li><code>kubernetes.io/hostname</code></li><li><code>failure-domain.beta.kubernetes.io/zone</code></li><li><code>failure-domain.beta.kubernetes.io/region</code></li><li><code>topology.kubernetes.io/zone</code></li><li><code>topology.kubernetes.io/region</code></li><li><code>beta.kubernetes.io/instance-type</code></li><li><code>node.kubernetes.io/instance-type</code></li><li><code>kubernetes.io/os</code></li><li><code>kubernetes.io/arch</code></li></ul><blockquote><p>è¯´æ˜ï¼š<br>è¿™äº›æ ‡ç­¾çš„å€¼æ˜¯ç‰¹å®šäºäº‘ä¾›åº”å•†çš„ï¼Œå› æ­¤ä¸èƒ½ä¿è¯å¯é ã€‚ä¾‹å¦‚ï¼Œ<code>kubernetes.io/hostname</code> çš„å€¼åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½ä¸èŠ‚ç‚¹åç§°ç›¸åŒï¼Œä½†åœ¨å…¶ä»–ç¯å¢ƒä¸­å¯èƒ½æ˜¯ä¸€ä¸ªä¸åŒçš„å€¼ã€‚</p></blockquote><p>ä¸èŠ‚ç‚¹äº²å’Œä¸€æ ·ï¼Œå½“å‰æœ‰ä¸¤ç§ç±»å‹çš„ pod äº²å’Œä¸åäº²å’Œï¼Œå³ <code>requiredDuringSchedulingIgnoredDuringExecution</code> å’Œ <code>preferredDuringSchedulingIgnoredDuringExecution</code>ï¼Œåˆ†è¡¨è¡¨ç¤ºâ€œç¡¬æ€§â€ä¸â€œè½¯æ€§â€è¦æ±‚ã€‚è¯·å‚é˜…å‰é¢èŠ‚ç‚¹äº²å’Œéƒ¨åˆ†ä¸­çš„æè¿°ã€‚<code>requiredDuringSchedulingIgnoredDuringExecution</code> äº²å’Œçš„ä¸€ä¸ªç¤ºä¾‹æ˜¯â€œå°†æœåŠ¡ A å’ŒæœåŠ¡ B çš„ pod æ”¾ç½®åœ¨åŒä¸€åŒºåŸŸï¼Œå› ä¸ºå®ƒä»¬ä¹‹é—´è¿›è¡Œå¤§é‡äº¤æµâ€ï¼Œè€Œ <code>preferredDuringSchedulingIgnoredDuringExecution</code> åäº²å’Œçš„ç¤ºä¾‹å°†æ˜¯â€œå°†æ­¤æœåŠ¡çš„ pod è·¨åŒºåŸŸåˆ†å¸ƒâ€ï¼ˆç¡¬æ€§è¦æ±‚æ˜¯è¯´ä¸é€šçš„ï¼Œå› ä¸ºä½ å¯èƒ½æ‹¥æœ‰çš„ pod æ•°å¤šäºåŒºåŸŸæ•°ï¼‰ã€‚</p><p>Pod é—´äº²å’Œé€šè¿‡ PodSpec ä¸­ <code>affinity</code> å­—æ®µä¸‹çš„ <code>podAffinity</code> å­—æ®µè¿›è¡ŒæŒ‡å®šã€‚è€Œ pod é—´åäº²å’Œé€šè¿‡ PodSpec ä¸­ <code>affinity</code> å­—æ®µä¸‹çš„ <code>podAntiAffinity</code> å­—æ®µè¿›è¡ŒæŒ‡å®š</p><p>Pod ä½¿ç”¨ pod äº²å’Œ çš„ç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: with-pod-affinity</span><br><span class="line">spec:</span><br><span class="line">  affinity:</span><br><span class="line">    podAffinity:</span><br><span class="line">      requiredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">      - labelSelector:</span><br><span class="line">          matchExpressions:</span><br><span class="line">          - key: security</span><br><span class="line">            operator: In</span><br><span class="line">            values:</span><br><span class="line">            - S1</span><br><span class="line">        topologyKey: failure-domain.beta.kubernetes.io&#x2F;zone</span><br><span class="line">    podAntiAffinity:</span><br><span class="line">      preferredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">      - weight: 100</span><br><span class="line">        podAffinityTerm:</span><br><span class="line">          labelSelector:</span><br><span class="line">            matchExpressions:</span><br><span class="line">            - key: security</span><br><span class="line">              operator: In</span><br><span class="line">              values:</span><br><span class="line">              - S2</span><br><span class="line">          topologyKey: failure-domain.beta.kubernetes.io&#x2F;zone</span><br><span class="line">  containers:</span><br><span class="line">  - name: with-pod-affinity</span><br><span class="line">    image: k8s.gcr.io&#x2F;pause:2.0</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ª pod çš„ affinity é…ç½®å®šä¹‰äº†ä¸€æ¡ pod äº²å’Œè§„åˆ™å’Œä¸€æ¡ pod åäº²å’Œè§„åˆ™ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>podAffinity</code> é…ç½®ä¸º <code>requiredDuringSchedulingIgnoredDuringExecution</code>ï¼Œç„¶è€Œ <code>podAntiAffinity</code> é…ç½®ä¸º <code>preferredDuringSchedulingIgnoredDuringExecution</code>ã€‚pod äº²å’Œè§„åˆ™è¡¨ç¤ºï¼Œä»…å½“èŠ‚ç‚¹å’Œè‡³å°‘ä¸€ä¸ªå·²è¿è¡Œä¸”æœ‰é”®ä¸ºâ€œsecurityâ€ä¸”å€¼ä¸ºâ€œS1â€çš„æ ‡ç­¾çš„ pod å¤„äºåŒä¸€åŒºåŸŸæ—¶ï¼Œæ‰å¯ä»¥å°†è¯¥ pod è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šã€‚ï¼ˆæ›´ç¡®åˆ‡çš„è¯´ï¼Œå¦‚æœèŠ‚ç‚¹ N å…·æœ‰å¸¦æœ‰é”® <code>failure-domain.beta.kubernetes.io/zone</code> å’ŒæŸä¸ªå€¼ V çš„æ ‡ç­¾ï¼Œåˆ™ pod æœ‰èµ„æ ¼åœ¨èŠ‚ç‚¹ N ä¸Šè¿è¡Œï¼Œä»¥ä¾¿é›†ç¾¤ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹å…·æœ‰é”® <code>failure-domain.beta.kubernetes.io/zone</code> å’Œå€¼ä¸º V çš„èŠ‚ç‚¹æ­£åœ¨è¿è¡Œå…·æœ‰é”®â€œsecurityâ€å’Œå€¼â€œS1â€çš„æ ‡ç­¾çš„ podã€‚ï¼‰pod åäº²å’Œè§„åˆ™è¡¨ç¤ºï¼Œå¦‚æœèŠ‚ç‚¹å·²ç»è¿è¡Œäº†ä¸€ä¸ªå…·æœ‰é”®â€œsecurityâ€å’Œå€¼â€œS2â€çš„æ ‡ç­¾çš„ podï¼Œåˆ™è¯¥ pod ä¸å¸Œæœ›å°†å…¶è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Šã€‚ï¼ˆå¦‚æœ <code>topologyKey</code> ä¸º <code>failure-domain.beta.kubernetes.io/zone</code>ï¼Œåˆ™æ„å‘³ç€å½“èŠ‚ç‚¹å’Œå…·æœ‰é”®â€œsecurityâ€å’Œå€¼â€œS2â€çš„æ ‡ç­¾çš„ pod å¤„äºç›¸åŒçš„åŒºåŸŸï¼Œpod ä¸èƒ½è¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Šã€‚ï¼‰</p><p>Pod äº²å’Œä¸åäº²å’Œçš„åˆæ³•æ“ä½œç¬¦æœ‰ <code>In</code>ï¼Œ<code>NotIn</code>ï¼Œ<code>Exists</code>ï¼Œ<code>DoesNotExist</code>ã€‚</p><p>åŸåˆ™ä¸Šï¼Œ<code>topologyKey</code> å¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„æ ‡ç­¾é”®ã€‚ç„¶è€Œï¼Œå‡ºäºæ€§èƒ½å’Œå®‰å…¨åŸå› ï¼ŒtopologyKey å—åˆ°ä¸€äº›é™åˆ¶ï¼š</p><ol><li>å¯¹äºäº²å’Œä¸ <code>requiredDuringSchedulingIgnoredDuringExecution</code> è¦æ±‚çš„ pod åäº²å’Œï¼Œ<code>topologyKey</code> ä¸å…è®¸ä¸ºç©ºã€‚</li><li>å¯¹äº <code>requiredDuringSchedulingIgnoredDuringExecution</code> è¦æ±‚çš„ pod åäº²å’Œï¼Œå‡†å…¥æ§åˆ¶å™¨ <code>LimitPodHardAntiAffinityTopology</code> è¢«å¼•å…¥æ¥é™åˆ¶ <code>topologyKey</code> ä¸ä¸º <code>kubernetes.io/hostname</code>ã€‚å¦‚æœä½ æƒ³ä½¿å®ƒå¯ç”¨äºè‡ªå®šä¹‰æ‹“æ‰‘ç»“æ„ï¼Œä½ å¿…é¡»ä¿®æ”¹å‡†å…¥æ§åˆ¶å™¨æˆ–è€…ç¦ç”¨å®ƒã€‚</li><li>å¯¹äº <code>preferredDuringSchedulingIgnoredDuringExecution</code> è¦æ±‚çš„ pod åäº²å’Œï¼Œç©ºçš„ <code>topologyKey</code> è¢«è§£é‡Šä¸ºâ€œæ‰€æœ‰æ‹“æ‰‘ç»“æ„â€ï¼ˆè¿™é‡Œçš„â€œæ‰€æœ‰æ‹“æ‰‘ç»“æ„â€é™åˆ¶ä¸º <code>kubernetes.io/hostname</code>ï¼Œ<code>failure-domain.beta.kubernetes.io/zone</code> å’Œ <code>failure-domain.beta.kubernetes.io/region</code> çš„ç»„åˆï¼‰ã€‚</li><li>é™¤ä¸Šè¿°æƒ…å†µå¤–ï¼Œ<code>topologyKey </code>å¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„æ ‡ç­¾é”®ã€‚</li></ol><p>é™¤äº† <code>labelSelector</code> å’Œ <code>topologyKey</code>ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å®šè¡¨ç¤ºå‘½åç©ºé—´çš„ <code>namespaces</code> é˜Ÿåˆ—ï¼Œ<code>labelSelector</code> ä¹Ÿåº”è¯¥åŒ¹é…å®ƒï¼ˆè¿™ä¸ªä¸ <code>labelSelector</code> å’Œ <code>topologyKey</code> çš„å®šä¹‰ä½äºç›¸åŒçš„çº§åˆ«ï¼‰ã€‚å¦‚æœå¿½ç•¥æˆ–è€…ä¸ºç©ºï¼Œåˆ™é»˜è®¤ä¸º pod äº²å’Œ/åäº²å’Œçš„å®šä¹‰æ‰€åœ¨çš„å‘½åç©ºé—´ã€‚</p><p>æ‰€æœ‰ä¸ <code>requiredDuringSchedulingIgnoredDuringExecution</code> äº²å’Œä¸åäº²å’Œå…³è”çš„ <code>matchExpressions</code> å¿…é¡»æ»¡è¶³ï¼Œæ‰èƒ½å°† pod è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šã€‚</p><p>é˜¿é‡Œäº‘nginx-ingressç¤ºä¾‹</p><p>åˆ†å¸ƒnginx-ingressåˆ°æ¯ä¸ªèŠ‚ç‚¹ åªæ˜¯éƒ¨åˆ†å†…å®¹è¯·å‹¿ç›´æ¥ä½¿ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">spec:</span><br><span class="line">  progressDeadlineSeconds: 600</span><br><span class="line">  replicas: 3</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: ingress-nginx</span><br><span class="line">  strategy:</span><br><span class="line">    rollingUpdate:</span><br><span class="line">      maxSurge: 25%</span><br><span class="line">      maxUnavailable: 25%</span><br><span class="line">    type: RollingUpdate</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      annotations:</span><br><span class="line">        prometheus.io&#x2F;port: &#39;10254&#39;</span><br><span class="line">        prometheus.io&#x2F;scrape: &#39;true&#39;</span><br><span class="line">        redeploy-timestamp: &#39;1597647322549&#39;</span><br><span class="line">      labels:</span><br><span class="line">        app: ingress-nginx</span><br><span class="line">    spec:</span><br><span class="line">      affinity:</span><br><span class="line">        nodeAffinity:</span><br><span class="line">          requiredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">            nodeSelectorTerms:</span><br><span class="line">              - matchExpressions:</span><br><span class="line">                  - key: type</span><br><span class="line">                    operator: NotIn</span><br><span class="line">                    values:</span><br><span class="line">                      - virtual-kubelet</span><br><span class="line">        podAntiAffinity:</span><br><span class="line">          preferredDuringSchedulingIgnoredDuringExecution:</span><br><span class="line">            - podAffinityTerm:</span><br><span class="line">                labelSelector:</span><br><span class="line">                  matchExpressions:</span><br><span class="line">                    - key: app</span><br><span class="line">                      operator: In</span><br><span class="line">                      values:</span><br><span class="line">                        - ingress-nginx</span><br><span class="line">                topologyKey: kubernetes.io&#x2F;hostname</span><br><span class="line">              weight: 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      nodeSelector:</span><br><span class="line">        beta.kubernetes.io&#x2F;os: linux</span><br></pre></td></tr></table></figure><h3><span id="taintæ±¡ç‚¹"> Taintï¼ˆæ±¡ç‚¹ï¼‰</span></h3><p><code>Taints</code>ï¼šé¿å…Podè°ƒåº¦åˆ°ç‰¹å®šNodeä¸Š</p><p>ä¸<code>nodeSelector</code> &amp; <code>nodeAffinity</code>åŒºåˆ«ï¼š</p><ul><li><code>nodeSelector</code> &amp; <code>nodeAffinity</code>ï¼šå°†podåˆ†é…åˆ°æŸäº›èŠ‚ç‚¹ã€‚podå±æ€§</li><li><code>Taints</code>ï¼šèŠ‚ç‚¹ä¸å…è®¸åˆ†é…podã€‚èŠ‚ç‚¹å±æ€§</li></ul><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ä¸“ç”¨èŠ‚ç‚¹</li><li>é…å¤‡äº†ç‰¹æ®Šç¡¬ä»¶çš„èŠ‚ç‚¹</li><li>åŸºäºTaintçš„é©±é€</li></ul><p>æŸ¥çœ‹èŠ‚ç‚¹æ±¡ç‚¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node &lt;node-name&gt; | grep Taint</span><br></pre></td></tr></table></figure><p>è®¾ç½®æ±¡ç‚¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint node &lt;node-name&gt; key&#x3D;value:&lt;effect&gt;</span><br></pre></td></tr></table></figure><p>ç»™èŠ‚ç‚¹ <code>&lt;node-name&gt;</code> å¢åŠ ä¸€ä¸ªæ±¡ç‚¹ï¼Œå®ƒçš„é”®åæ˜¯ <code>key</code>ï¼Œé”®å€¼æ˜¯ <code>value</code>ï¼Œæ•ˆæœæ˜¯ <code>NoSchedule</code>ã€‚ è¿™è¡¨ç¤ºåªæœ‰æ‹¥æœ‰å’Œè¿™ä¸ªæ±¡ç‚¹ç›¸åŒ¹é…çš„å®¹å¿åº¦çš„ Pod æ‰èƒ½å¤Ÿè¢«åˆ†é…åˆ° <code>&lt;node-name&gt;</code> è¿™ä¸ªèŠ‚ç‚¹</p><p>å…¶ä¸­<code>&lt;effect&gt;</code> å¯å–å€¼ï¼š</p><ul><li>NoSchedule ï¼šä¸€å®šä¸èƒ½è¢«è°ƒåº¦ï¼ˆå·²ç»è°ƒåº¦çš„ä¸ä¼šè¢«é©±é€ï¼‰ã€‚</li><li>PreferNoScheduleï¼šå°½é‡ä¸è¦è°ƒåº¦ï¼ˆè½¯æ€§ï¼‰ã€‚</li><li>NoExecuteï¼šä¸ä»…ä¸ä¼šè°ƒåº¦ï¼Œè¿˜ä¼šé©±é€Nodeä¸Šå·²æœ‰çš„Podï¼ˆè‹¥podä¸ºè®¾ç½®æ±¡ç‚¹å®¹å¿ï¼‰ã€‚</li></ul><p>å»æ‰æ±¡ç‚¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint node &lt;node-name&gt; key:&lt;effect&gt;-</span><br></pre></td></tr></table></figure><h3><span id="tolerationsæ±¡ç‚¹å®¹å¿"> Tolerationsï¼ˆæ±¡ç‚¹å®¹å¿ï¼‰</span></h3><p><code>Tolerations</code>ï¼šå…è®¸Podè°ƒåº¦åˆ°æœ‰ç‰¹å®šTaintsçš„Nodeä¸Š</p><p>yamlç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: pod-taints</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - name: pod-taints</span><br><span class="line">    image: busybox:latest</span><br><span class="line">  tolerations:</span><br><span class="line">  - key: &quot;key&quot;</span><br><span class="line">    operator: &quot;Equal&quot;</span><br><span class="line">    value: &quot;value&quot;</span><br><span class="line">    effect: &quot;NoSchedule&quot;</span><br></pre></td></tr></table></figure><p><code>operator</code> çš„é»˜è®¤å€¼æ˜¯ <code>Equal</code>ã€‚</p><p>ä¸€ä¸ªå®¹å¿åº¦å’Œä¸€ä¸ªæ±¡ç‚¹ç›¸â€œåŒ¹é…â€æ˜¯æŒ‡å®ƒä»¬æœ‰ä¸€æ ·çš„é”®åå’Œæ•ˆæœï¼Œå¹¶ä¸”ï¼š</p><ul><li>å¦‚æœ <code>operator</code> æ˜¯ <code>Exists</code> ï¼ˆæ­¤æ—¶å®¹å¿åº¦ä¸èƒ½æŒ‡å®š <code>value</code>ï¼‰ï¼Œæˆ–è€…</li><li>å¦‚æœ<code> operator</code> æ˜¯ <code>Equal</code> ï¼Œåˆ™å®ƒä»¬çš„ <code>value</code> åº”è¯¥ç›¸ç­‰</li></ul><p>nodeæ ¹æ®çŠ¶æ€ä¹Ÿä¼šè‡ªåŠ¨æ‰“ä¸€äº›æ±¡ç‚¹ï¼š</p><ul><li><code>node.kubernetes.io/not-ready</code>ï¼šèŠ‚ç‚¹æœªå‡†å¤‡å¥½ã€‚è¿™ç›¸å½“äºèŠ‚ç‚¹çŠ¶æ€ Ready çš„å€¼ä¸º â€œFalseâ€ã€‚</li><li><code>node.kubernetes.io/unreachable</code>ï¼šèŠ‚ç‚¹æ§åˆ¶å™¨è®¿é—®ä¸åˆ°èŠ‚ç‚¹. è¿™ç›¸å½“äºèŠ‚ç‚¹çŠ¶æ€ Ready çš„å€¼ä¸º â€œUnknownâ€ã€‚</li><li><code>node.kubernetes.io/out-of-disk</code>ï¼šèŠ‚ç‚¹ç£ç›˜è€—å°½ã€‚</li><li><code>node.kubernetes.io/memory-pressure</code>ï¼šèŠ‚ç‚¹å­˜åœ¨å†…å­˜å‹åŠ›ã€‚</li><li><code>node.kubernetes.io/disk-pressure</code>ï¼šèŠ‚ç‚¹å­˜åœ¨ç£ç›˜å‹åŠ›ã€‚</li><li><code>node.kubernetes.io/network-unavailable</code>ï¼šèŠ‚ç‚¹ç½‘ç»œä¸å¯ç”¨ã€‚</li><li><code>node.kubernetes.io/unschedulable</code>: èŠ‚ç‚¹ä¸å¯è°ƒåº¦ã€‚</li><li><code>node.cloudprovider.kubernetes.io/uninitialized</code>ï¼šå¦‚æœ kubelet å¯åŠ¨æ—¶æŒ‡å®šäº†ä¸€ä¸ª â€œå¤–éƒ¨â€ äº‘å¹³å°é©±åŠ¨ï¼Œ å®ƒå°†ç»™å½“å‰èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªæ±¡ç‚¹å°†å…¶æ ‡å¿—ä¸ºä¸å¯ç”¨ã€‚åœ¨ cloud-controller-manager çš„ä¸€ä¸ªæ§åˆ¶å™¨åˆå§‹åŒ–è¿™ä¸ªèŠ‚ç‚¹åï¼Œkubelet å°†åˆ é™¤è¿™ä¸ªæ±¡ç‚¹ã€‚</li></ul><blockquote><p>å®¹å¿æ±¡ç‚¹ï¼šä¸æ˜¯å¼ºåˆ¶æ€§åˆ†é…åˆ°å…·æœ‰æ±¡ç‚¹çš„èŠ‚ç‚¹ä¸Šï¼Œé…ç½®äº†å®¹å¿æ±¡ç‚¹ï¼Œåœ¨è°ƒåº¦æ—¶å¿½ç•¥èŠ‚ç‚¹æ±¡ç‚¹</p></blockquote><h3><span id="nodename"> nodeName</span></h3><p><code>nodeName</code>ï¼šç”¨äºå°†Podè°ƒåº¦åˆ°æŒ‡å®šçš„Nodeä¸Šï¼Œä¸ç»è¿‡è°ƒåº¦å™¨ï¼ˆ<code>default-scheduler</code>ï¼‰</p><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>è°ƒåº¦ç»„ä»¶æ•…éšœï¼Œå¸Œæœ›ä¸´æ—¶æ•‘æ€¥</li></ul><p>yamlç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  name: pod-example</span><br><span class="line">  labels:</span><br><span class="line">    app: nginx</span><br><span class="line">spec:</span><br><span class="line">  nodeName: k8s-node2</span><br><span class="line">  containers:</span><br><span class="line">  - name: nginx</span><br><span class="line">    image: nginx:1.15</span><br></pre></td></tr></table></figure><h3><span id="daemonsetå®ˆæŠ¤è¿›ç¨‹é›†"> DaemonSetï¼ˆå®ˆæŠ¤è¿›ç¨‹é›†ï¼‰</span></h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/img/image-88e599f6.png" alt="github--lena"></p><p><code>DaemonSet</code>åŠŸèƒ½ï¼š</p><ul><li>åœ¨æ¯ä¸€ä¸ªNodeä¸Šè¿è¡Œä¸€ä¸ªPod</li><li>æ–°åŠ å…¥çš„Nodeä¹ŸåŒæ ·ä¼šè‡ªåŠ¨è¿è¡Œä¸€ä¸ªPod</li></ul><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç½‘ç»œæ’ä»¶</li><li>Agentï¼ˆzabbix-agentç›‘æ§ï¼‰</li><li>æ—¥å¿—é‡‡é›†ï¼ˆfilebeatï¼‰</li><li>C/Sæ¶æ„è½¯ä»¶</li><li>å¿…è¦çš„åˆ†å‘æœåŠ¡ä¾‹å¦‚ nginx-ingress</li></ul><p>yamlç¤ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: apps&#x2F;v1</span><br><span class="line">kind: DaemonSet</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    app: web</span><br><span class="line">  name: filebeat</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: web</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: web</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - image: nginx</span><br><span class="line">        name: nginx</span><br><span class="line">        resources: &#123;&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>kubectl get pod</code>å¯ä»¥å‘ç°<code>filebeat</code>åœ¨æ¯ä¸ªnodeä¸Šéƒ½éƒ¨ç½²äº†ä¸€ä¸ªï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master k8s]# kubectl get pod -o wide</span><br><span class="line">NAME                         READY   STATUS             RESTARTS   AGE     IP               NODE        NOMINATED NODE   READINESS GATES</span><br><span class="line">filebeat-9kc9d               1&#x2F;1     Running            0          8s      10.244.36.118    k8s-node1   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">filebeat-wsbxb               1&#x2F;1     Running            0          8s      10.244.169.183   k8s-node2   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹daemonsetï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master k8s]# kubectl get ds</span><br><span class="line">NAME       DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE</span><br><span class="line">filebeat   2         2         2       2            2           &lt;none&gt;          3m2s</span><br></pre></td></tr></table></figure><h2><span id="è°ƒåº¦å¤±è´¥åŸå› åˆ†æ"> è°ƒåº¦å¤±è´¥åŸå› åˆ†æ</span></h2><p>æŸ¥çœ‹è°ƒåº¦ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pod &lt;NAME&gt; -o wide</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹è°ƒåº¦å¤±è´¥åŸå› ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod &lt;NAME&gt;</span><br></pre></td></tr></table></figure><p>é”™è¯¯è§£æï¼š</p><ul><li>æ²¡æœ‰åŒ¹é…åˆ°æ ‡ç­¾çš„æç¤ºä¿¡æ¯ï¼š<br>0/3 nodes are available: 3 node(s) didnâ€™t match node selector.</li><li>æ²¡æœ‰è¶³å¤Ÿçš„cpuèµ„æºåˆ†é…ï¼š<br>0/3 nodes are available: 3 Insufficient cpu.</li><li>3ä¸ªèŠ‚ç‚¹æœ‰æ±¡ç‚¹ï¼Œæ²¡æœ‰é…ç½®æ±¡ç‚¹å®¹å¿:<br>0/3 nodes are available: 3 node(s) had taints that the pod didnâ€™t tolerate.</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;æ¦‚å¿µ&quot;&gt; æ¦‚å¿µ&lt;/span&gt;&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://kubernetes.io/zh/docs/concepts/scheduling-eviction/assign-pod-node/&quot;&gt;Kubernetes è°ƒåº¦å’Œé©±é€</summary>
      
    
    
    
    <category term="Kubernetes" scheme="https://imszz.com/categories/Kubernetes/"/>
    
    
    <category term="Kubernetes" scheme="https://imszz.com/tags/Kubernetes/"/>
    
    <category term="nodeSelector" scheme="https://imszz.com/tags/nodeSelector/"/>
    
    <category term="nodeAffinity" scheme="https://imszz.com/tags/nodeAffinity/"/>
    
    <category term="podAntiAffinity" scheme="https://imszz.com/tags/podAntiAffinity/"/>
    
    <category term="podAffinity" scheme="https://imszz.com/tags/podAffinity/"/>
    
    <category term="nodeName" scheme="https://imszz.com/tags/nodeName/"/>
    
  </entry>
  
  <entry>
    <title>æŸ¥è¯¢DNSçš„è®°å½• æŸ¥çœ‹åŸŸåè§£ææ˜¯å¦æ­£å¸¸</title>
    <link href="https://imszz.com/p/3d65889c/"/>
    <id>https://imszz.com/p/3d65889c/</id>
    <published>2020-08-23T13:25:23.000Z</published>
    <updated>2020-09-07T05:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>#nslookupå‘½ä»¤ç”¨äºæŸ¥è¯¢DNSçš„è®°å½•ï¼ŒæŸ¥çœ‹åŸŸåè§£ææ˜¯å¦æ­£å¸¸ï¼Œåœ¨ç½‘ç»œæ•…éšœçš„æ—¶å€™ç”¨æ¥è¯Šæ–­ç½‘ç»œé—®é¢˜ã€‚</p><h4><span id="ç›´æ¥æŸ¥è¯¢">ç›´æ¥æŸ¥è¯¢</span></h4><p>æŸ¥è¯¢ä¸€ä¸ªåŸŸåçš„Aè®°å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup domain [dns-server]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nslookup www.google.com 8.8.8.8</span><br><span class="line">Server:8.8.8.8</span><br><span class="line">Address:8.8.8.8#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:www.google.com</span><br><span class="line">Address: 172.217.5.196</span><br></pre></td></tr></table></figure><h4><span id="æŸ¥è¯¢å…¶ä»–è®°å½•">æŸ¥è¯¢å…¶ä»–è®°å½•</span></h4><p>æŒ‡å®šå‚æ•°ï¼ŒæŸ¥è¯¢å…¶ä»–è®°å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -qt&#x3D;type domain [dns-server]</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œtypeå¯ä»¥æ˜¯ä»¥ä¸‹è¿™äº›ç±»å‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">A åœ°å€è®°å½•</span><br><span class="line">AAAA åœ°å€è®°å½•</span><br><span class="line">AFSDB Andrewæ–‡ä»¶ç³»ç»Ÿæ•°æ®åº“æœåŠ¡å™¨è®°å½•</span><br><span class="line">ATMA ATMåœ°å€è®°å½•</span><br><span class="line">CNAME åˆ«åè®°å½•</span><br><span class="line">HINFO ç¡¬ä»¶é…ç½®è®°å½•ï¼ŒåŒ…æ‹¬CPUã€æ“ä½œç³»ç»Ÿä¿¡æ¯</span><br><span class="line">ISDN åŸŸåå¯¹åº”çš„ISDNå·ç </span><br><span class="line">MB å­˜æ”¾æŒ‡å®šé‚®ç®±çš„æœåŠ¡å™¨</span><br><span class="line">MG é‚®ä»¶ç»„è®°å½•</span><br><span class="line">MINFO é‚®ä»¶ç»„å’Œé‚®ç®±çš„ä¿¡æ¯è®°å½•</span><br><span class="line">MR æ”¹åçš„é‚®ç®±è®°å½•</span><br><span class="line">MX é‚®ä»¶æœåŠ¡å™¨è®°å½•</span><br><span class="line">NS åå­—æœåŠ¡å™¨è®°å½•</span><br><span class="line">PTR åå‘è®°å½•</span><br><span class="line">RP è´Ÿè´£äººè®°å½•</span><br><span class="line">RT è·¯ç”±ç©¿é€è®°å½•</span><br><span class="line">SRV TCPæœåŠ¡å™¨ä¿¡æ¯è®°å½•</span><br><span class="line">TXT åŸŸåå¯¹åº”çš„æ–‡æœ¬ä¿¡æ¯</span><br><span class="line">X25 åŸŸåå¯¹åº”çš„X.25åœ°å€è®°å½•</span><br></pre></td></tr></table></figure><h4><span id="æŸ¥è¯¢æ›´å…·ä½“çš„ä¿¡æ¯">æŸ¥è¯¢æ›´å…·ä½“çš„ä¿¡æ¯</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup â€“d [å…¶ä»–å‚æ•°] domain [dns-server]</span><br></pre></td></tr></table></figure><p>åªè¦åœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼ŒåŠ ä¸Š-då‚æ•°ï¼Œå³å¯æŸ¥è¯¢åŸŸåçš„ç¼“å­˜ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;#nslookupå‘½ä»¤ç”¨äºæŸ¥è¯¢DNSçš„è®°å½•ï¼ŒæŸ¥çœ‹åŸŸåè§£ææ˜¯å¦æ­£å¸¸ï¼Œåœ¨ç½‘ç»œæ•…éšœçš„æ—¶å€™ç”¨æ¥è¯Šæ–­ç½‘ç»œé—®é¢˜ã€‚&lt;/p&gt;
&lt;h4&gt;&lt;span id=&quot;ç›´æ¥æŸ¥è¯¢&quot;&gt;ç›´æ¥æŸ¥è¯¢&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;æŸ¥è¯¢ä¸€ä¸ªåŸŸåçš„Aè®°å½•&lt;/p&gt;
&lt;figure class=&quot;highlight pla</summary>
      
    
    
    
    <category term="tools" scheme="https://imszz.com/categories/tools/"/>
    
    
    <category term="nslookup" scheme="https://imszz.com/tags/nslookup/"/>
    
  </entry>
  
  <entry>
    <title>è½¯è‘—ç»Ÿè®¡ä»£ç è¡Œæ•°</title>
    <link href="https://imszz.com/p/c2e90d73/"/>
    <id>https://imszz.com/p/c2e90d73/</id>
    <published>2020-08-16T16:46:25.000Z</published>
    <updated>2020-08-17T13:25:23.000Z</updated>
    
    <content type="html"><![CDATA[<h3><span id="è¯·ç»Ÿè®¡ä»£ç è¡Œæ•°">è¯·ç»Ÿè®¡ä»£ç è¡Œæ•°</span></h3><h4><span id="ç»Ÿè®¡ä»£ç è¡Œæ•°">ç»Ÿè®¡ä»£ç è¡Œæ•°</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find mall-imeihao-h5      \( -name &#39;*.js&#39; -o -name &#39;*.json&#39; -o -name &#39;*.wxss&#39; -o -name &#39;*.wxml&#39; \) | xargs cat |grep -v ^$| wc -l</span><br></pre></td></tr></table></figure><ul><li>.wxml .wxss .json .js ä¸ºæºç æ–‡ä»¶æ‰©å±•åï¼Œæ ¹æ®éœ€æ±‚æ›¿æ¢</li></ul><h4><span id="éœ€è¦æ’é™¤çš„ç›®å½•">éœ€è¦æ’é™¤çš„ç›®å½•</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find  mall-imeihao \</span><br><span class="line">\( -path .&#x2F;web -o -path .&#x2F;runtime -o -path .&#x2F;config \) -prune -o \</span><br><span class="line">\( -name &quot;*.php&quot; -o -name &quot;*.js&quot; -o -name &quot;*.css&quot; -o -name &quot;*.scss&quot; \) \</span><br><span class="line">|  xargs cat |grep -v ^$| wc -l</span><br></pre></td></tr></table></figure><ul><li>web runtime config ä¸ºéœ€è¦æ’é™¤çš„ç›®å½•</li></ul><h3><span id="å¯¼å…¥æ–‡æ¡£">å¯¼å…¥æ–‡æ¡£</span></h3><h4><span id="å¯¼å…¥æ–‡æ¡£æ ¼å¼">å¯¼å…¥æ–‡æ¡£æ ¼å¼</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find mall-imeihao-reception  \( -name &#39;*.py&#39;  \) | xargs cat |grep -v ^$| &gt; mall-imeihao-reception.docx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3&gt;&lt;span id=&quot;è¯·ç»Ÿè®¡ä»£ç è¡Œæ•°&quot;&gt;è¯·ç»Ÿè®¡ä»£ç è¡Œæ•°&lt;/span&gt;&lt;/h3&gt;&lt;h4&gt;&lt;span id=&quot;ç»Ÿè®¡ä»£ç è¡Œæ•°&quot;&gt;ç»Ÿè®¡ä»£ç è¡Œæ•°&lt;/span&gt;&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt</summary>
      
    
    
    
    <category term="script" scheme="https://imszz.com/categories/script/"/>
    
    
    <category term="shell" scheme="https://imszz.com/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>HTTrack - å…‹éš†ä»»æ„ç½‘ç«™</title>
    <link href="https://imszz.com/p/8a11f10a/"/>
    <id>https://imszz.com/p/8a11f10a/</id>
    <published>2020-08-15T12:46:25.000Z</published>
    <updated>2020-08-16T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>HTTrackå¯ä»¥å…‹éš†æŒ‡å®šç½‘ç«™ï¼æŠŠæ•´ä¸ªç½‘ç«™ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p><p>å¯ä»¥ç”¨åœ¨ç¦»çº¿æµè§ˆä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ”¶é›†ä¿¡æ¯ï¼ˆç”šè‡³æœ‰ç½‘ç«™ä½¿ç”¨éšè—çš„å¯†ç æ–‡ä»¶ï¼‰ã€‚</p><p>ä¸€äº›ä»¿çœŸåº¦æé«˜çš„ä¼ªç½‘ç«™ï¼ˆä¸ºäº†éª—å–ç”¨æˆ·å¯†ç ï¼‰ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ç±»ä¼¼å·¥å…·åšçš„ã€‚<br>Linuxé»˜è®¤å®‰è£…äº†HTTrack. å¦‚æ²¡æœ‰å¯ä»¥è‡ªè¡Œä¸‹è½½å®‰è£…ã€‚<br>Liunx å®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum provides httrack</span><br><span class="line">yum install httrack</span><br></pre></td></tr></table></figure><p>MacOS zsh:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install httrack</span><br></pre></td></tr></table></figure><p>HTTrackå¸®åŠ©ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httrack --help</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç¤ºä¾‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httrack https:&#x2F;&#x2F;imszz.com&#x2F;navi -O &#x2F;tmp</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å‘½ä»¤å…‹éš†äº†ç½‘ç«™è·¯å¾„ä¸‹æ‰€æœ‰å†…å®¹ï¼Œä¸å¸¦è·¯å¾„å…‹éš†æ‰€æœ‰å†…å®¹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;HTTrackå¯ä»¥å…‹éš†æŒ‡å®šç½‘ç«™ï¼æŠŠæ•´ä¸ªç½‘ç«™ä¸‹è½½åˆ°æœ¬åœ°ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç”¨åœ¨ç¦»çº¿æµè§ˆä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ”¶é›†ä¿¡æ¯ï¼ˆç”šè‡³æœ‰ç½‘ç«™ä½¿ç”¨éšè—çš„å¯†ç æ–‡ä»¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›ä»¿çœŸåº¦æé«˜çš„ä¼ªç½‘ç«™ï¼ˆä¸ºäº†éª—å–ç”¨æˆ·å¯†ç ï¼‰ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ç±»ä¼¼å·¥å…·åšçš„ã€‚&lt;br&gt;Linuxé»˜è®¤å®‰è£…äº†HTTrack. å¦‚æ²¡</summary>
      
    
    
    
    <category term="tools" scheme="https://imszz.com/categories/tools/"/>
    
    
    <category term="HTTrack" scheme="https://imszz.com/tags/HTTrack/"/>
    
  </entry>
  
  <entry>
    <title>hexoä¿®å‰ªåœ°å€æ </title>
    <link href="https://imszz.com/p/292fbf59/"/>
    <id>https://imszz.com/p/292fbf59/</id>
    <published>2020-08-15T12:46:25.000Z</published>
    <updated>2020-08-16T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h3><span id="å‰è¨€">å‰è¨€</span></h3><p>hexoæ–‡ç« é“¾æ¥é»˜è®¤çš„ç”Ÿæˆè§„åˆ™æ˜¯ï¼š<code>:year/:month/:day/:title</code>æ˜¯æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€æ ‡é¢˜æ¥ç”Ÿæˆçš„</p><p>æ¯”å¦‚é»˜è®¤ç”Ÿæˆï¼š<code>https://imszz.com/2020/07/21/hello-world/</code></p><p>éå¸¸ä¸åˆ©äºé˜…è¯»,ä¸­æ–‡ä¹Ÿå¯èƒ½å‡ºç°ä¹±ç ,ä¹Ÿå½±å“æ”¶å½•ã€‚</p><p>ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼šä½¿ç”¨<code>hexo-permalink-pinyin</code>æ’ä»¶ï¼Œå°†ä¸­æ–‡è½¬è‹±æ–‡ï¼Œå¥½åƒæ˜¯æœ‰ç¼ºé™·</p><p>å¦ä¸€ç§æ–¹æ¡ˆ: ä½¿ç”¨ <code>hexo-abbrlink</code> æ’ä»¶, ç”ŸæˆçŸ­é“¾ï¼Œä¸”é“¾æ¥ä¸ä¼šå› ä¸ºæ›´æ–°æ¬¡æ•°è¿‡å¤šå‡ºç°æ”¹åŠ¨</p><h3><span id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><h3><span id="é…ç½®">é…ç½®</span></h3><p>ä¿®æ”¹æ ¹ç›®å½•ç«™ç‚¹é…ç½®æ–‡ä»¶<code>config.yml</code>ï¼Œæ”¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#permalink: :year&#x2F;:month&#x2F;:day&#x2F;:title&#x2F;  # æ³¨é‡Šæˆ–è€…åˆ é™¤</span><br><span class="line">permalink: p&#x2F;:abbrlink&#x2F;  # æ­¤å¤„å¯ä»¥è‡ªå·±è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ :&#x2F;abbrlink ï¼Œå»ºè®®å‰é¢å¸¦ç›®å½•ï¼Œä¸ç„¶å¤ªä¹±</span><br><span class="line">abbrlink:</span><br><span class="line">    alg: crc32  #ç®—æ³•ï¼š crc16(default) and crc32</span><br><span class="line">    rep: hex  #è¿›åˆ¶ï¼š dec(default) and hex</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„é“¾æ¥å°†ä¼šæ˜¯è¿™æ ·çš„(å®˜æ–¹æ ·ä¾‹)ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">crc16 &amp; hex</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;p&#x2F;66c8.html</span><br><span class="line"></span><br><span class="line">crc16 &amp; dec</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;p&#x2F;65535.html</span><br><span class="line">crc32 &amp; hex</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;p&#x2F;8ddf18fb.html</span><br><span class="line"></span><br><span class="line">crc32 &amp; dec</span><br><span class="line">https:&#x2F;&#x2F;post.zz173.com&#x2F;p&#x2F;1690090958.html</span><br></pre></td></tr></table></figure><h3><span id="ä½¿ç”¨">ä½¿ç”¨</span></h3><p>åœ¨æ–‡ç« çš„ <code>Front-matter</code> å†…ä¼šå¢åŠ <code>abbrlink</code> å­—æ®µï¼Œå€¼ä¸ºç”Ÿæˆçš„ID ã€‚è¿™ä¸ªå­—æ®µç¡®ä¿äº†åœ¨æˆ‘ä»¬ä¿®æ”¹äº†<code>Front-matter</code> å†…çš„åšå®¢æ ‡é¢˜<code>title</code>æˆ–åˆ›å»ºæ—¥æœŸ<code>date</code>å­—æ®µä¹‹åè€Œä¸ä¼šæ”¹å˜é“¾æ¥åœ°å€ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">categories:</span><br><span class="line"> -</span><br><span class="line">tags:</span><br><span class="line">-</span><br><span class="line">abbrlink:  #ç•™ç©ºå°±å¥½ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¹¶ä¸ä¼šå› ä¸‹æ¬¡æ›´æ–°æ–‡ç« è€Œå˜åŠ¨</span><br><span class="line">---</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3&gt;&lt;span id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;hexoæ–‡ç« é“¾æ¥é»˜è®¤çš„ç”Ÿæˆè§„åˆ™æ˜¯ï¼š&lt;code&gt;:year/:month/:day/:title&lt;/code&gt;æ˜¯æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€æ ‡é¢˜æ¥ç”Ÿæˆçš„&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚é»˜è®¤ç”Ÿæˆï¼š&lt;code&gt;https://imszz.c</summary>
      
    
    
    
    <category term="hexo" scheme="https://imszz.com/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://imszz.com/tags/hexo/"/>
    
    <category term="abbrlink" scheme="https://imszz.com/tags/abbrlink/"/>
    
  </entry>
  
  <entry>
    <title>hexo æ·»åŠ è‡ªå®šä¹‰å•é™æ€é¡µé¢ è·³è¿‡hexoæ¸²æŸ“</title>
    <link href="https://imszz.com/p/6ea05e36/"/>
    <id>https://imszz.com/p/6ea05e36/</id>
    <published>2020-08-13T12:46:25.000Z</published>
    <updated>2020-09-07T12:46:25.000Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="å‰è¨€">å‰è¨€</span></h2><p>Hexoé»˜è®¤ä¼šå¯¹<code>/source/</code>é‡Œçš„æ‰€æœ‰é¡µé¢åº”ç”¨ä¸»é¢˜æ¨¡æ¿æ¸²æŸ“ï¼Œä½†æœ‰ä¸€äº›å‰ç«¯ä½œå“æˆ–demoé¡µæˆ‘ä»¬ä¸å¸Œæœ›ç»è¿‡æ¸²æŸ“ï¼Œè€Œæ˜¯èƒ½ä¿æŒå®Œå…¨è‡ªå®šä¹‰çš„æ ·å­</p><p>ä¾‹å¦‚ï¼š</p><ol><li>ä¸»é¢˜å†…æ¸²æŸ“ï¼Œæ·»åŠ çš„æ¨¡å—ä»åœ¨ä¸»é¢˜å†…ï¼Œä¸»é¢˜å¤´éƒ¨ä¿¡æ¯ä¾ç„¶å­˜åœ¨ï¼Œä»…ä»…æ˜¯åœ¨ç‰¹å®šåŒºåŸŸè¿›è¡Œæ¸²æŸ“ï¼ˆé€‚åˆæ·»åŠ  about é¡µé¢ï¼‰</li><li>å®Œå…¨é¡µé¢æ¸²æŸ“ï¼Œåœ¨ä¸»é¢˜å†…ç‚¹å‡»å¯¹åº”é“¾æ¥è·³è½¬åˆ°ä¸€ä¸ªå®Œå…¨å´­æ–°çš„é¡µé¢ï¼ˆæˆ‘éœ€è¦çš„ï¼‰</li></ol><h3><span id="hexo-çš„æ‰§è¡Œé€»è¾‘">hexo çš„æ‰§è¡Œé€»è¾‘</span></h3><p>source æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾äº†å¾…è¢«è½¬åŒ–çš„ markdown æ–‡ä»¶ï¼Œåœ¨æ‰§è¡Œ<code>hexo g</code>å‘½ä»¤æ—¶ï¼Œsource ç›®å½•ä¸‹çš„æ–‡ä»¶å°†è¢«è½¬åŒ–ä¸º html æ–‡ä»¶ã€‚</p><h2><span id="ä»‹ç»ä¸¤ç§æ–¹æ³•">ä»‹ç»ä¸¤ç§æ–¹æ³•ï¼š</span></h2><h3><span id="ä½¿ç”¨hexoæä¾›çš„è·³è¿‡æ¸²æŸ“é…ç½®é€‚ç”¨äºæ•´ä¸ªç›®å½•çš„è®¾ç½®">ä½¿ç”¨Hexoæä¾›çš„è·³è¿‡æ¸²æŸ“é…ç½®ï¼Œé€‚ç”¨äºæ•´ä¸ªç›®å½•çš„è®¾ç½®ã€‚</span></h3><p>å…·ä½“æ­¥éª¤ï¼Œæ‰“å¼€åšå®¢æ ¹ç›®å½•<code>_config.yml</code>ï¼Œæ‰¾åˆ°å…¶ä¸­<code>skip_render</code>é¡¹ï¼Œè¿™ä¸ªé¡¹ç›®ç”¨æ¥é…ç½®<code>/source/</code>ä¸­éœ€è¦è·³è¿‡æ¸²æŸ“çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œ</p><p>ä¾‹å¦‚å¸Œæœ›è·³è¿‡<code>/source/navi/</code>é‡Œçš„æ‰€æœ‰æ–‡ä»¶æ¸²æŸ“ï¼ˆè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†è‡ªå·±çš„ä½œå“æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åå¯ä»¥é€šè¿‡è‡ªå·±çš„ç½‘å€/navi/â€¦è®¿é—®äº†)</p><p>å¯ä»¥é…ç½®ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skip_render: navi&#x2F;**</span><br></pre></td></tr></table></figure><ul><li><code>source/navi/</code>ç›®å½•ä¸‹æ·»åŠ ã€Œå·¥å…·ç›’ã€æºæ–‡ä»¶</li><li>åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­é…ç½®<code>skin_render</code>é¡¹ï¼Œå¦‚ï¼š<code>skip_render: navi/**</code>ï¼Œè¿™æ ·projectsæ–‡ä»¶å¤¹ä¸‹çš„æ‰€ä»¥æ–‡ä»¶å†…å®¹å°†ä¸ä¼šè½¬åŒ–ä¸º htmlï¼Œç›´æ¥è¢« copy åˆ° public æ–‡ä»¶å¤¹</li><li>åœ¨ã€Œå·¥å…·ç›’ã€æ–‡ä»¶å¤¹ä¸‹æ·»åŠ  index.html æ–‡ä»¶ç”¨äºæ¸²æŸ“è‡ªå®šä¹‰é¡µé¢</li></ul><p>å®Œæˆä»¥ä¸Šæ­¥éª¤å³å¯ç‚¹å‡»ã€Œå·¥å…·ç›’ã€èœå•å¯¼èˆªï¼Œå®Œæˆè‡ªå®šä¹‰é¡µé¢çš„å±•ç¤ºã€‚</p><p>ä¿®æ”¹äº†é…ç½®ä½†ç”Ÿæˆå‡ºæ¥çš„å†…å®¹ä¸ä¸€å®šåŠæ—¶åº”ç”¨äº†æ–°é…ç½®ï¼Œæœ€å¥½åœ¨ç”Ÿæˆä¹‹å‰æ‰§è¡Œä¸€ä¸‹<code>hexo clean</code>å‘½ä»¤ï¼Œæ¸…é™¤æ‰æ—§çš„ç”Ÿæˆæ–‡ä»¶å’Œç¼“å­˜ã€‚</p><h3><span id="ç»™å•ä¸ªæ–‡ä»¶æ·»åŠ ä¸åº”ç”¨æ¨¡æ¿çš„æ ‡è®°é€‚ç”¨äºä¸ªåˆ«ç‰¹æ®Šæ–‡ä»¶çš„å¤„ç†"> ç»™å•ä¸ªæ–‡ä»¶æ·»åŠ ä¸åº”ç”¨æ¨¡æ¿çš„æ ‡è®°ï¼Œé€‚ç”¨äºä¸ªåˆ«ç‰¹æ®Šæ–‡ä»¶çš„å¤„ç†ã€‚</span></h3><p>ä¾‹å¦‚æˆ‘ä»¬è¦ä½¿ <code>about</code> é¡µé¢è·³è¿‡æ¸²æŸ“ï¼Œåˆ›å»º <code>/source/about/index.md</code>ï¼Œå°†è¿™ä¸ªé¡µé¢çš„ç›¸å…³ HTML ä»£ç å†™è¿›<code>.md</code>æ–‡ä»¶å¹¶ä¿å­˜ï¼Œç„¶ååœ¨ <code>index.md</code> çš„å¤´éƒ¨å†™å…¥ï¼šï¼Œ</p><p>é¿å…æ¸²æŸ“çš„åŠæ³•å°±æ˜¯åœ¨æ–‡ä»¶å¤´éƒ¨<code>Front-matter </code>é‡Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">layout: false</span><br><span class="line">---</span><br><span class="line">&#123;% raw %&#125;</span><br><span class="line">xxxxxxxxxxxxx</span><br><span class="line">xx HTMLä»£ç  xx</span><br><span class="line">xxxxxxxxxxxxx</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>PSï¼š<code>Front-matter</code> æ˜¯ <code>.md</code> æ–‡ä»¶æœ€ä¸Šæ–¹ä»¥ â€” åˆ†éš”çš„åŒºåŸŸï¼Œç”¨äºæŒ‡å®šä¸ªåˆ«æ–‡ä»¶çš„å˜é‡ï¼Œå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://hexo.io/docs/front-matter">https://hexo.io/docs/front-matter</a><br><code>.md</code>æ–‡ä»¶ä¸­çš„ HTML ä»£ç è¦ç”¨ <code>` å’Œ `</code> åŒ…èµ·æ¥ï¼Œä½¿å…¶èƒ½æ­£ç¡®ç¼–è¯‘é‡Œé¢çš„ä»£ç ã€€ã€€</p></blockquote><p>è¿™æ ·ï¼Œè¿™ä¸ªæ–‡ä»¶å°±ä¸ä¼šç»è¿‡æ¨¡æ¿æ¸²æŸ“ï¼Œæœ€ç»ˆå‘å¸ƒåˆ°<code>/public/</code>é‡Œçš„æ–‡ä»¶å°±æ˜¯å»æ‰æ ‡è®°åçš„æ–‡ä»¶çš„æ ·å­ã€‚</p><p>ä½†æ˜¯è¿™ç§æœªå°è¯•ï¼ æ¨èç¬¬ä¸€ç§</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;å‰è¨€&quot;&gt;å‰è¨€&lt;/span&gt;&lt;/h2&gt;

&lt;p&gt;Hexoé»˜è®¤ä¼šå¯¹&lt;code&gt;/source/&lt;/code&gt;é‡Œçš„æ‰€æœ‰é¡µé¢åº”ç”¨ä¸»é¢˜æ¨¡æ¿æ¸²æŸ“ï¼Œä½†æœ‰ä¸€äº›å‰ç«¯ä½œå“æˆ–demoé¡µæˆ‘ä»¬ä¸å¸Œæœ›ç»è¿‡æ¸²æŸ“ï¼Œè€Œæ˜¯èƒ½ä¿æŒå®Œå…¨è‡ªå®šä¹‰çš„æ ·å­&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;</summary>
      
    
    
    
    <category term="hexo" scheme="https://imszz.com/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://imszz.com/tags/hexo/"/>
    
  </entry>
  
</feed>
